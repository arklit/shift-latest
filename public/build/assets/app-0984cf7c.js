var ur=Object.defineProperty;var pr=(n,e,t)=>e in n?ur(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ze=(n,e,t)=>(pr(n,typeof e!="symbol"?e+"":e,t),t);import{c as he,g as fr}from"./_commonjsHelpers-725317a4.js";function mr(n){let e=n.querySelector('button[type="submit"]');const t=new FormData(n),i=new XMLHttpRequest;yr(n,t),i.open("POST","/ajax/send-modal"),i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE&&i.status===200){const r=JSON.parse(i.responseText);if(r.success)wr(n);else{const o=r.errors,a=document.createElement("div"),s=document.createElement("p"),c=document.createElement("ul");vr(a,s,c),Object.values(o).forEach(function(d,h){br(c,d);let u=n.querySelector(`[name="item[${Object.keys(o)[h]}]"]`);u&&fe(u,!1)});const l=document.querySelector(".modal-header");l.parentNode.insertBefore(a,l.nextSibling),Er(n,o),_n(e,!1),gr()}}},i.send(t)}function gr(){const n=document.querySelectorAll(".btn-close");console.log(n),n.forEach(e=>{console.log(e),e.addEventListener("click",()=>{const t=e.parentNode.nextSibling;t&&t.classList.contains("error-block")&&t.remove()})}),window.addEventListener("click",e=>{if(!e.target.closest(".modal-content")){const t=document.querySelector(".error-block");t&&t.remove()}})}function vr(n,e,t){n.classList="error-block alert alert-danger rounded shadow-sm mb-3 p-4",e.insertAdjacentHTML("afterbegin","<strong>О нет! </strong> Измените пару вещей и повторите попытку."),n.appendChild(e),n.appendChild(t)}function br(n,e){const t=document.createElement("li");t.insertAdjacentHTML("afterbegin",e),n.appendChild(t)}function yr(n,e){const r=n.querySelector(".modal-body").firstElementChild.getAttribute("id");e.append("item[modal_id]",r)}function wr(n){const e=n.querySelectorAll("input[required], textarea[required], select[required]");let t=!1;if(e.forEach(i=>{i.value.trim()===""&&(t=!0)}),t)e[0].focus();else{const i=n.querySelector(".error-block");i&&i.remove(),n.submit()}}function Er(n,e){const t=Object.keys(e);if(t.length>0){const i=t[0],r=n.querySelector(`[name="item[${i}]"]`);if(r){const o=r.offsetTop-100,a=n.closest(".modal");a.scrollTo({top:o,behavior:"smooth"}),a.addEventListener("scroll",function s(){a.scrollTop===o&&(r.focus(),a.removeEventListener("scroll",s))})}}}function ki(n,e){n.querySelectorAll("*").forEach(function(i){i.style.opacity=e})}function _n(n,e){const t='<span class="spinner-loading position-absolute top-50 start-50 translate-middle"><span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span></span>';e?(ki(n,"0"),n.classList="btn btn-default cursor-wait btn-loading",n.disabled=!0,n.insertAdjacentHTML("beforeend",t)):(n.querySelector(".spinner-loading").remove(),n.classList="btn btn-default",ki(n,"1"),n.disabled=!1)}function _r(n,e){n.addEventListener("click",t=>{t.preventDefault();const i=document.querySelector(".error-block");i&&i.remove(),_n(n,!0),mr(e)})}function Li(n){fe(n,n.value.trim()!=="")}function Ni(n){const e=n.tomselect;fe(n.nextElementSibling,e.isValid===!0),e.on("change",function(){fe(n.nextElementSibling,e.isValid===!0)})}function Fi(n){const e=n.closest(".cropper-parent"),t=e.querySelector(".cropper-actions"),i=e.querySelector("img"),r=i.getAttribute("src");r===""||r==="#"?(t.classList.remove("border-dashed"),fe(t,!1)):(t.classList.remove("border-dashed"),fe(t,!0)),new MutationObserver(a=>{for(const s of a)if(s.type==="attributes"&&s.attributeName==="src"){const c=i.getAttribute("src");c===""||c==="#"?fe(t,!1):fe(t,!0)}}).observe(i,{attributes:!0})}function Cr(){document.querySelectorAll('.dropzone-wrapper[data-required="required"]').forEach(function(e){const t=Dropzone.forElement(e);if(t){const i=e.querySelector(".uploader-field"),r=e.querySelector(".uploader-data");fe(i,t.files.length!==0),je(t,r),t.on("addedfile",function(){fe(i,t.files.length!==0),je(t,r)}),t.on("removedfile",function(){fe(i,t.files.length!==0),je(t,r)})}})}function Sr(){document.querySelectorAll('.dropzone-wrapper[data-required="required"]').forEach(function(e){const t=Dropzone.forElement(e);if(t){const i=e.querySelector(".uploader-data");je(t,i),t.on("addedfile",function(){je(t,i)}),t.on("removedfile",function(){je(t,i)})}})}function je(n,e){e&&(e.value=n.files.length===0?"":n.files.length)}function Dr(n){if(!n.classList.contains("tinymce"))return;const e=setInterval(()=>{let t=tinymce.get(n.id);if(t){let r=function(){n.value=t.getContent()};clearInterval(e),n.closest('[data-controller="tinymce"]').querySelector(".tox-tinymce"),r(),t.on("keyup",r),t.on("change",r)}},1e3)}function xr(n){let e=tinymce.get(n.id);const i=n.closest('[data-controller="tinymce"]').querySelector(".tox-tinymce");function r(){n.value=e.getContent(),fe(i,e.getContent({format:"text"}).trim()!=="")}r(),e.on("keyup",r),e.on("change",r)}function Tr(){document.querySelectorAll(".tinymce[required]").forEach(e=>{Dr(e)})}Cn();document.addEventListener("turbo:load",Cn);function Ii(n,e,t){n.addEventListener(t,()=>{e.querySelectorAll("input[required], textarea[required], select[required]").forEach(r=>{Ar(r)}),Cr()})}function Ar(n){n.classList.contains("cropper-path")?(Fi(n),n.addEventListener("change",()=>Fi(n))):n.classList.contains("tinymce")?xr(n):n.tagName.toLowerCase()==="select"?(Ni(n),n.addEventListener("change",()=>Ni(n))):(Li(n),n.addEventListener("input",()=>Li(n)))}function fe(n,e){if(n!==null){const t=n.classList,i="validation-success",r="validation-error";e?(t.remove(r),t.add(i)):(t.remove(i),t.add(r))}}function Cn(){let n=document.getElementById("post-form"),e=document.querySelectorAll(".modal-content");Tr(),Ii(n,n,"submit"),e.forEach(t=>{let i=t.querySelector('button[type="submit"]');i&&(Ii(i,t,"click"),_r(i,t))}),setTimeout(()=>{Sr()},300)}Tn();document.addEventListener("turbo:load",Tn);function Sn(n){n.style.display="block";let e=n.parentElement.closest(".list");if(e){let t=e.parentElement.dataset.branch;n.dataset.branch.startsWith(t)&&Sn(e.parentElement)}}function Dn(n){n.style.display="block",n.querySelectorAll(".list > li").forEach(function(t){let i=t.dataset.branch,r=n.dataset.branch;i.startsWith(r)&&Dn(t)})}function Mr(n){let e=document.querySelectorAll(".main-list li");e.forEach(function(t){t.style.display="none"}),e.forEach(function(t){t.querySelector(".label .page-name").textContent.toLowerCase().includes(n.toLowerCase())&&(Sn(t),Dn(t),xn())})}function Or(){document.querySelectorAll(".closed-img").forEach(function(n){n.addEventListener("click",function(e){let t=this.parentNode,i=t.parentNode,r=t.nextElementSibling;i.classList.contains("is-open")?(r.style.display="none",i.classList.remove("is-open"),t.querySelector(".closed-img").classList.remove("open")):(r.style.display="block",i.classList.add("is-open"),t.querySelector(".closed-img").classList.add("open"))})})}function kr(){document.querySelectorAll(".list").forEach(function(n){n.parentNode.classList.remove("is-open"),n.style.display="none"}),document.querySelectorAll(".has-children").forEach(function(n){n.classList.remove("is-open")}),document.querySelectorAll(".closed-img").forEach(function(n){n.classList.remove("open")})}function xn(){document.querySelectorAll(".parent > .list").forEach(function(e){e.style.display="block"}),document.querySelectorAll(".has-children").forEach(function(e){e.classList.add("is-open")}),document.querySelectorAll(".closed-img").forEach(function(e){e.classList.add("open")})}function Lr(n,e){let t;return function(...i){clearTimeout(t),t=setTimeout(()=>n.apply(this,i),e)}}function Tn(){setTimeout(()=>{let n=document.getElementById("search-tree");n&&(Or(),document.querySelector(".uncollapse-all").addEventListener("click",xn),document.querySelector(".collapse-all").addEventListener("click",kr),n.addEventListener("input",Lr(function(){let e=n.value;Mr(e)},200)))},300)}window.addEventListener("scroll",function(){var n=document.querySelector(".command-bar-wrapper"),e=document.querySelector(".command-bar-wrapper .commandbar-layout"),t=n.getBoundingClientRect().top;t<=0?e.classList.add("sticky"):e.classList.remove("sticky")});function Nr(n,e){n.querySelectorAll("[data-file-id]").forEach((i,r)=>{e.querySelectorAll('input[type="hidden"][class*="files-"]').forEach((a,s)=>{r===s&&(a.value=i.dataset.fileId,a.classList.remove([...a.classList].filter(c=>c.startsWith("files-"))[0]),a.classList.add(`files-${i.dataset.fileId}`))})})}function Fr(n){n.forEach(e=>{let t=e.querySelector(".dropzone-previews");t&&new MutationObserver(()=>{Nr(t,e)}).observe(t,{childList:!0})})}function Ir(n){for(const e of n)if(e.type==="childList"){const t=document.querySelectorAll('[data-controller="upload"]');if(t.length>0){Fr(t),Ei.disconnect();break}}}const Ei=new MutationObserver(Ir);document.addEventListener("turbo:load",()=>{Ei.observe(document.documentElement,{childList:!0,subtree:!0})});document.addEventListener("DOMContentLoaded",()=>{Ei.observe(document.documentElement,{childList:!0,subtree:!0})});/*!
 * Cropper.js v1.6.1
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-09-17T03:44:19.860Z
 */function Ri(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function An(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ri(Object(t),!0).forEach(function(i){Br(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ri(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function ai(n){"@babel/helpers - typeof";return ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ai(n)}function Rr(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function zi(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,On(i.key),i)}}function zr(n,e,t){return e&&zi(n.prototype,e),t&&zi(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Br(n,e,t){return e=On(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Mn(n){return Pr(n)||qr(n)||Hr(n)||Ur()}function Pr(n){if(Array.isArray(n))return si(n)}function qr(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Hr(n,e){if(n){if(typeof n=="string")return si(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return si(n,e)}}function si(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Ur(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yr(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function On(n){var e=Yr(n,"string");return typeof e=="symbol"?e:String(e)}var zt=typeof window<"u"&&typeof window.document<"u",we=zt?window:{},_i=zt&&we.document.documentElement?"ontouchstart"in we.document.documentElement:!1,Ci=zt?"PointerEvent"in we:!1,Y="cropper",Si="all",kn="crop",Ln="move",Nn="zoom",Fe="e",Ie="w",qe="s",De="n",Je="ne",et="nw",tt="se",it="sw",li="".concat(Y,"-crop"),Bi="".concat(Y,"-disabled"),se="".concat(Y,"-hidden"),Pi="".concat(Y,"-hide"),Wr="".concat(Y,"-invisible"),kt="".concat(Y,"-modal"),ci="".concat(Y,"-move"),ut="".concat(Y,"Action"),vt="".concat(Y,"Preview"),Di="crop",Fn="move",In="none",di="crop",hi="cropend",ui="cropmove",pi="cropstart",qi="dblclick",Xr=_i?"touchstart":"mousedown",Vr=_i?"touchmove":"mousemove",jr=_i?"touchend touchcancel":"mouseup",Hi=Ci?"pointerdown":Xr,Ui=Ci?"pointermove":Vr,Yi=Ci?"pointerup pointercancel":jr,Wi="ready",Xi="resize",Vi="wheel",fi="zoom",ji="image/jpeg",Gr=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Kr=/^data:/,Qr=/^data:image\/jpeg;base64,/,$r=/^img|canvas$/i,Rn=200,zn=100,Gi={viewMode:0,dragMode:Di,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Rn,minContainerHeight:zn,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Zr='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Jr=Number.isNaN||we.isNaN;function R(n){return typeof n=="number"&&!Jr(n)}var Ki=function(e){return e>0&&e<1/0};function qt(n){return typeof n>"u"}function Pe(n){return ai(n)==="object"&&n!==null}var eo=Object.prototype.hasOwnProperty;function We(n){if(!Pe(n))return!1;try{var e=n.constructor,t=e.prototype;return e&&t&&eo.call(t,"isPrototypeOf")}catch{return!1}}function ae(n){return typeof n=="function"}var to=Array.prototype.slice;function Bn(n){return Array.from?Array.from(n):to.call(n)}function Z(n,e){return n&&ae(e)&&(Array.isArray(n)||R(n.length)?Bn(n).forEach(function(t,i){e.call(n,t,i,n)}):Pe(n)&&Object.keys(n).forEach(function(t){e.call(n,n[t],t,n)})),n}var W=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Pe(e)&&i.length>0&&i.forEach(function(o){Pe(o)&&Object.keys(o).forEach(function(a){e[a]=o[a]})}),e},io=/\.\d*(?:0|9){12}\d*$/;function Ge(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return io.test(n)?Math.round(n*e)/e:n}var no=/^width|height|left|top|marginLeft|marginTop$/;function Ae(n,e){var t=n.style;Z(e,function(i,r){no.test(r)&&R(i)&&(i="".concat(i,"px")),t[r]=i})}function ro(n,e){return n.classList?n.classList.contains(e):n.className.indexOf(e)>-1}function J(n,e){if(e){if(R(n.length)){Z(n,function(i){J(i,e)});return}if(n.classList){n.classList.add(e);return}var t=n.className.trim();t?t.indexOf(e)<0&&(n.className="".concat(t," ").concat(e)):n.className=e}}function be(n,e){if(e){if(R(n.length)){Z(n,function(t){be(t,e)});return}if(n.classList){n.classList.remove(e);return}n.className.indexOf(e)>=0&&(n.className=n.className.replace(e,""))}}function Xe(n,e,t){if(e){if(R(n.length)){Z(n,function(i){Xe(i,e,t)});return}t?J(n,e):be(n,e)}}var oo=/([a-z\d])([A-Z])/g;function xi(n){return n.replace(oo,"$1-$2").toLowerCase()}function mi(n,e){return Pe(n[e])?n[e]:n.dataset?n.dataset[e]:n.getAttribute("data-".concat(xi(e)))}function pt(n,e,t){Pe(t)?n[e]=t:n.dataset?n.dataset[e]=t:n.setAttribute("data-".concat(xi(e)),t)}function ao(n,e){if(Pe(n[e]))try{delete n[e]}catch{n[e]=void 0}else if(n.dataset)try{delete n.dataset[e]}catch{n.dataset[e]=void 0}else n.removeAttribute("data-".concat(xi(e)))}var Pn=/\s\s*/,qn=function(){var n=!1;if(zt){var e=!1,t=function(){},i=Object.defineProperty({},"once",{get:function(){return n=!0,e},set:function(o){e=o}});we.addEventListener("test",t,i),we.removeEventListener("test",t,i)}return n}();function me(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=t;e.trim().split(Pn).forEach(function(o){if(!qn){var a=n.listeners;a&&a[o]&&a[o][t]&&(r=a[o][t],delete a[o][t],Object.keys(a[o]).length===0&&delete a[o],Object.keys(a).length===0&&delete n.listeners)}n.removeEventListener(o,r,i)})}function ue(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=t;e.trim().split(Pn).forEach(function(o){if(i.once&&!qn){var a=n.listeners,s=a===void 0?{}:a;r=function(){delete s[o][t],n.removeEventListener(o,r,i);for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];t.apply(n,d)},s[o]||(s[o]={}),s[o][t]&&n.removeEventListener(o,s[o][t],i),s[o][t]=r,n.listeners=s}n.addEventListener(o,r,i)})}function Ke(n,e,t){var i;return ae(Event)&&ae(CustomEvent)?i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent"),i.initCustomEvent(e,!0,!0,t)),n.dispatchEvent(i)}function Hn(n){var e=n.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ht=we.location,so=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Qi(n){var e=n.match(so);return e!==null&&(e[1]!==Ht.protocol||e[2]!==Ht.hostname||e[3]!==Ht.port)}function $i(n){var e="timestamp=".concat(new Date().getTime());return n+(n.indexOf("?")===-1?"?":"&")+e}function at(n){var e=n.rotate,t=n.scaleX,i=n.scaleY,r=n.translateX,o=n.translateY,a=[];R(r)&&r!==0&&a.push("translateX(".concat(r,"px)")),R(o)&&o!==0&&a.push("translateY(".concat(o,"px)")),R(e)&&e!==0&&a.push("rotate(".concat(e,"deg)")),R(t)&&t!==1&&a.push("scaleX(".concat(t,")")),R(i)&&i!==1&&a.push("scaleY(".concat(i,")"));var s=a.length?a.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function lo(n){var e=An({},n),t=0;return Z(n,function(i,r){delete e[r],Z(e,function(o){var a=Math.abs(i.startX-o.startX),s=Math.abs(i.startY-o.startY),c=Math.abs(i.endX-o.endX),l=Math.abs(i.endY-o.endY),d=Math.sqrt(a*a+s*s),h=Math.sqrt(c*c+l*l),u=(h-d)/d;Math.abs(u)>Math.abs(t)&&(t=u)})}),t}function bt(n,e){var t=n.pageX,i=n.pageY,r={endX:t,endY:i};return e?r:An({startX:t,startY:i},r)}function co(n){var e=0,t=0,i=0;return Z(n,function(r){var o=r.startX,a=r.startY;e+=o,t+=a,i+=1}),e/=i,t/=i,{pageX:e,pageY:t}}function Me(n){var e=n.aspectRatio,t=n.height,i=n.width,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",o=Ki(i),a=Ki(t);if(o&&a){var s=t*e;r==="contain"&&s>i||r==="cover"&&s<i?t=i/e:i=t*e}else o?t=i/e:a&&(i=t*e);return{width:i,height:t}}function ho(n){var e=n.width,t=n.height,i=n.degree;if(i=Math.abs(i)%180,i===90)return{width:t,height:e};var r=i%90*Math.PI/180,o=Math.sin(r),a=Math.cos(r),s=e*a+t*o,c=e*o+t*a;return i>90?{width:c,height:s}:{width:s,height:c}}function uo(n,e,t,i){var r=e.aspectRatio,o=e.naturalWidth,a=e.naturalHeight,s=e.rotate,c=s===void 0?0:s,l=e.scaleX,d=l===void 0?1:l,h=e.scaleY,u=h===void 0?1:h,f=t.aspectRatio,g=t.naturalWidth,b=t.naturalHeight,E=i.fillColor,S=E===void 0?"transparent":E,T=i.imageSmoothingEnabled,A=T===void 0?!0:T,B=i.imageSmoothingQuality,H=B===void 0?"low":B,p=i.maxWidth,v=p===void 0?1/0:p,D=i.maxHeight,x=D===void 0?1/0:D,m=i.minWidth,C=m===void 0?0:m,_=i.minHeight,k=_===void 0?0:_,N=document.createElement("canvas"),F=N.getContext("2d"),P=Me({aspectRatio:f,width:v,height:x}),K=Me({aspectRatio:f,width:C,height:k},"cover"),G=Math.min(P.width,Math.max(K.width,g)),te=Math.min(P.height,Math.max(K.height,b)),Le=Me({aspectRatio:r,width:v,height:x}),I=Me({aspectRatio:r,width:C,height:k},"cover"),X=Math.min(Le.width,Math.max(I.width,o)),re=Math.min(Le.height,Math.max(I.height,a)),Ne=[-X/2,-re/2,X,re];return N.width=Ge(G),N.height=Ge(te),F.fillStyle=S,F.fillRect(0,0,G,te),F.save(),F.translate(G/2,te/2),F.rotate(c*Math.PI/180),F.scale(d,u),F.imageSmoothingEnabled=A,F.imageSmoothingQuality=H,F.drawImage.apply(F,[n].concat(Mn(Ne.map(function(hr){return Math.floor(Ge(hr))})))),F.restore(),N}var Un=String.fromCharCode;function po(n,e,t){var i="";t+=e;for(var r=e;r<t;r+=1)i+=Un(n.getUint8(r));return i}var fo=/^data:.*,/;function mo(n){var e=n.replace(fo,""),t=atob(e),i=new ArrayBuffer(t.length),r=new Uint8Array(i);return Z(r,function(o,a){r[a]=t.charCodeAt(a)}),i}function go(n,e){for(var t=[],i=8192,r=new Uint8Array(n);r.length>0;)t.push(Un.apply(null,Bn(r.subarray(0,i)))),r=r.subarray(i);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function vo(n){var e=new DataView(n),t;try{var i,r,o;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var a=e.byteLength,s=2;s+1<a;){if(e.getUint8(s)===255&&e.getUint8(s+1)===225){r=s;break}s+=1}if(r){var c=r+4,l=r+10;if(po(e,c,4)==="Exif"){var d=e.getUint16(l);if(i=d===18761,(i||d===19789)&&e.getUint16(l+2,i)===42){var h=e.getUint32(l+4,i);h>=8&&(o=l+h)}}}if(o){var u=e.getUint16(o,i),f,g;for(g=0;g<u;g+=1)if(f=o+g*12+2,e.getUint16(f,i)===274){f+=8,t=e.getUint16(f,i),e.setUint16(f,1,i);break}}}catch{t=1}return t}function bo(n){var e=0,t=1,i=1;switch(n){case 2:t=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:i}}var yo={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,r=this.cropper,o=Number(t.minContainerWidth),a=Number(t.minContainerHeight);J(r,se),be(e,se);var s={width:Math.max(i.offsetWidth,o>=0?o:Rn),height:Math.max(i.offsetHeight,a>=0?a:zn)};this.containerData=s,Ae(r,{width:s.width,height:s.height}),J(e,se),be(r,se)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,r=Math.abs(t.rotate)%180===90,o=r?t.naturalHeight:t.naturalWidth,a=r?t.naturalWidth:t.naturalHeight,s=o/a,c=e.width,l=e.height;e.height*s>e.width?i===3?c=e.height*s:l=e.width/s:i===3?l=e.width/s:c=e.height*s;var d={aspectRatio:s,naturalWidth:o,naturalHeight:a,width:c,height:l};this.canvasData=d,this.limited=i===1||i===2,this.limitCanvas(!0,!0),d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth),d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight),d.left=(e.width-d.width)/2,d.top=(e.height-d.height)/2,d.oldLeft=d.left,d.oldTop=d.top,this.initialCanvasData=W({},d)},limitCanvas:function(e,t){var i=this.options,r=this.containerData,o=this.canvasData,a=this.cropBoxData,s=i.viewMode,c=o.aspectRatio,l=this.cropped&&a;if(e){var d=Number(i.minCanvasWidth)||0,h=Number(i.minCanvasHeight)||0;s>1?(d=Math.max(d,r.width),h=Math.max(h,r.height),s===3&&(h*c>d?d=h*c:h=d/c)):s>0&&(d?d=Math.max(d,l?a.width:0):h?h=Math.max(h,l?a.height:0):l&&(d=a.width,h=a.height,h*c>d?d=h*c:h=d/c));var u=Me({aspectRatio:c,width:d,height:h});d=u.width,h=u.height,o.minWidth=d,o.minHeight=h,o.maxWidth=1/0,o.maxHeight=1/0}if(t)if(s>(l?0:1)){var f=r.width-o.width,g=r.height-o.height;o.minLeft=Math.min(0,f),o.minTop=Math.min(0,g),o.maxLeft=Math.max(0,f),o.maxTop=Math.max(0,g),l&&this.limited&&(o.minLeft=Math.min(a.left,a.left+(a.width-o.width)),o.minTop=Math.min(a.top,a.top+(a.height-o.height)),o.maxLeft=a.left,o.maxTop=a.top,s===2&&(o.width>=r.width&&(o.minLeft=Math.min(0,f),o.maxLeft=Math.max(0,f)),o.height>=r.height&&(o.minTop=Math.min(0,g),o.maxTop=Math.max(0,g))))}else o.minLeft=-o.width,o.minTop=-o.height,o.maxLeft=r.width,o.maxTop=r.height},renderCanvas:function(e,t){var i=this.canvasData,r=this.imageData;if(t){var o=ho({width:r.naturalWidth*Math.abs(r.scaleX||1),height:r.naturalHeight*Math.abs(r.scaleY||1),degree:r.rotate||0}),a=o.width,s=o.height,c=i.width*(a/i.naturalWidth),l=i.height*(s/i.naturalHeight);i.left-=(c-i.width)/2,i.top-=(l-i.height)/2,i.width=c,i.height=l,i.aspectRatio=a/s,i.naturalWidth=a,i.naturalHeight=s,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Ae(this.canvas,W({width:i.width,height:i.height},at({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,r=i.naturalWidth*(t.width/t.naturalWidth),o=i.naturalHeight*(t.height/t.naturalHeight);W(i,{width:r,height:o,left:(t.width-r)/2,top:(t.height-o)/2}),Ae(this.image,W({width:i.width,height:i.height},at(W({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,r=Number(e.autoCropArea)||.8,o={width:t.width,height:t.height};i&&(t.height*i>t.width?o.height=o.width/i:o.width=o.height*i),this.cropBoxData=o,this.limitCropBox(!0,!0),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),o.width=Math.max(o.minWidth,o.width*r),o.height=Math.max(o.minHeight,o.height*r),o.left=t.left+(t.width-o.width)/2,o.top=t.top+(t.height-o.height)/2,o.oldLeft=o.left,o.oldTop=o.top,this.initialCropBoxData=W({},o)},limitCropBox:function(e,t){var i=this.options,r=this.containerData,o=this.canvasData,a=this.cropBoxData,s=this.limited,c=i.aspectRatio;if(e){var l=Number(i.minCropBoxWidth)||0,d=Number(i.minCropBoxHeight)||0,h=s?Math.min(r.width,o.width,o.width+o.left,r.width-o.left):r.width,u=s?Math.min(r.height,o.height,o.height+o.top,r.height-o.top):r.height;l=Math.min(l,r.width),d=Math.min(d,r.height),c&&(l&&d?d*c>l?d=l/c:l=d*c:l?d=l/c:d&&(l=d*c),u*c>h?u=h/c:h=u*c),a.minWidth=Math.min(l,h),a.minHeight=Math.min(d,u),a.maxWidth=h,a.maxHeight=u}t&&(s?(a.minLeft=Math.max(0,o.left),a.minTop=Math.max(0,o.top),a.maxLeft=Math.min(r.width,o.left+o.width)-a.width,a.maxTop=Math.min(r.height,o.top+o.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=r.width-a.width,a.maxTop=r.height-a.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&pt(this.face,ut,i.width>=t.width&&i.height>=t.height?Ln:Si),Ae(this.cropBox,W({width:i.width,height:i.height},at({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ke(this.element,di,this.getData())}},wo={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,r=t?this.crossOriginUrl:this.url,o=e.alt||"The image to preview",a=document.createElement("img");if(t&&(a.crossOrigin=t),a.src=r,a.alt=o,this.viewBox.appendChild(a),this.viewBoxImage=a,!!i){var s=i;typeof i=="string"?s=e.ownerDocument.querySelectorAll(i):i.querySelector&&(s=[i]),this.previews=s,Z(s,function(c){var l=document.createElement("img");pt(c,vt,{width:c.offsetWidth,height:c.offsetHeight,html:c.innerHTML}),t&&(l.crossOrigin=t),l.src=r,l.alt=o,l.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',c.innerHTML="",c.appendChild(l)})}},resetPreview:function(){Z(this.previews,function(e){var t=mi(e,vt);Ae(e,{width:t.width,height:t.height}),e.innerHTML=t.html,ao(e,vt)})},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,r=i.width,o=i.height,a=e.width,s=e.height,c=i.left-t.left-e.left,l=i.top-t.top-e.top;!this.cropped||this.disabled||(Ae(this.viewBoxImage,W({width:a,height:s},at(W({translateX:-c,translateY:-l},e)))),Z(this.previews,function(d){var h=mi(d,vt),u=h.width,f=h.height,g=u,b=f,E=1;r&&(E=u/r,b=o*E),o&&b>f&&(E=f/o,g=r*E,b=f),Ae(d,{width:g,height:b}),Ae(d.getElementsByTagName("img")[0],W({width:a*E,height:s*E},at(W({translateX:-c*E,translateY:-l*E},e))))}))}},Eo={bind:function(){var e=this.element,t=this.options,i=this.cropper;ae(t.cropstart)&&ue(e,pi,t.cropstart),ae(t.cropmove)&&ue(e,ui,t.cropmove),ae(t.cropend)&&ue(e,hi,t.cropend),ae(t.crop)&&ue(e,di,t.crop),ae(t.zoom)&&ue(e,fi,t.zoom),ue(i,Hi,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&ue(i,Vi,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&ue(i,qi,this.onDblclick=this.dblclick.bind(this)),ue(e.ownerDocument,Ui,this.onCropMove=this.cropMove.bind(this)),ue(e.ownerDocument,Yi,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&ue(window,Xi,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;ae(t.cropstart)&&me(e,pi,t.cropstart),ae(t.cropmove)&&me(e,ui,t.cropmove),ae(t.cropend)&&me(e,hi,t.cropend),ae(t.crop)&&me(e,di,t.crop),ae(t.zoom)&&me(e,fi,t.zoom),me(i,Hi,this.onCropStart),t.zoomable&&t.zoomOnWheel&&me(i,Vi,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&me(i,qi,this.onDblclick),me(e.ownerDocument,Ui,this.onCropMove),me(e.ownerDocument,Yi,this.onCropEnd),t.responsive&&me(window,Xi,this.onResize)}},_o={resize:function(){if(!this.disabled){var e=this.options,t=this.container,i=this.containerData,r=t.offsetWidth/i.width,o=t.offsetHeight/i.height,a=Math.abs(r-1)>Math.abs(o-1)?r:o;if(a!==1){var s,c;e.restore&&(s=this.getCanvasData(),c=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(Z(s,function(l,d){s[d]=l*a})),this.setCropBoxData(Z(c,function(l,d){c[d]=l*a})))}}},dblclick:function(){this.disabled||this.options.dragMode===In||this.setDragMode(ro(this.dragBox,li)?Fn:Di)},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,r=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?r=e.deltaY>0?1:-1:e.wheelDelta?r=-e.wheelDelta/120:e.detail&&(r=e.detail>0?1:-1),this.zoom(-r*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(R(t)&&t!==1||R(i)&&i!==0||e.ctrlKey))){var r=this.options,o=this.pointers,a;e.changedTouches?Z(e.changedTouches,function(s){o[s.identifier]=bt(s)}):o[e.pointerId||0]=bt(e),Object.keys(o).length>1&&r.zoomable&&r.zoomOnTouch?a=Nn:a=mi(e.target,ut),Gr.test(a)&&Ke(this.element,pi,{originalEvent:e,action:a})!==!1&&(e.preventDefault(),this.action=a,this.cropping=!1,a===kn&&(this.cropping=!0,J(this.dragBox,kt)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var i=this.pointers;e.preventDefault(),Ke(this.element,ui,{originalEvent:e,action:t})!==!1&&(e.changedTouches?Z(e.changedTouches,function(r){W(i[r.identifier]||{},bt(r,!0))}):W(i[e.pointerId||0]||{},bt(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?Z(e.changedTouches,function(r){delete i[r.identifier]}):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Xe(this.dragBox,kt,this.cropped&&this.options.modal)),Ke(this.element,hi,{originalEvent:e,action:t}))}}},Co={change:function(e){var t=this.options,i=this.canvasData,r=this.containerData,o=this.cropBoxData,a=this.pointers,s=this.action,c=t.aspectRatio,l=o.left,d=o.top,h=o.width,u=o.height,f=l+h,g=d+u,b=0,E=0,S=r.width,T=r.height,A=!0,B;!c&&e.shiftKey&&(c=h&&u?h/u:1),this.limited&&(b=o.minLeft,E=o.minTop,S=b+Math.min(r.width,i.width,i.left+i.width),T=E+Math.min(r.height,i.height,i.top+i.height));var H=a[Object.keys(a)[0]],p={x:H.endX-H.startX,y:H.endY-H.startY},v=function(x){switch(x){case Fe:f+p.x>S&&(p.x=S-f);break;case Ie:l+p.x<b&&(p.x=b-l);break;case De:d+p.y<E&&(p.y=E-d);break;case qe:g+p.y>T&&(p.y=T-g);break}};switch(s){case Si:l+=p.x,d+=p.y;break;case Fe:if(p.x>=0&&(f>=S||c&&(d<=E||g>=T))){A=!1;break}v(Fe),h+=p.x,h<0&&(s=Ie,h=-h,l-=h),c&&(u=h/c,d+=(o.height-u)/2);break;case De:if(p.y<=0&&(d<=E||c&&(l<=b||f>=S))){A=!1;break}v(De),u-=p.y,d+=p.y,u<0&&(s=qe,u=-u,d-=u),c&&(h=u*c,l+=(o.width-h)/2);break;case Ie:if(p.x<=0&&(l<=b||c&&(d<=E||g>=T))){A=!1;break}v(Ie),h-=p.x,l+=p.x,h<0&&(s=Fe,h=-h,l-=h),c&&(u=h/c,d+=(o.height-u)/2);break;case qe:if(p.y>=0&&(g>=T||c&&(l<=b||f>=S))){A=!1;break}v(qe),u+=p.y,u<0&&(s=De,u=-u,d-=u),c&&(h=u*c,l+=(o.width-h)/2);break;case Je:if(c){if(p.y<=0&&(d<=E||f>=S)){A=!1;break}v(De),u-=p.y,d+=p.y,h=u*c}else v(De),v(Fe),p.x>=0?f<S?h+=p.x:p.y<=0&&d<=E&&(A=!1):h+=p.x,p.y<=0?d>E&&(u-=p.y,d+=p.y):(u-=p.y,d+=p.y);h<0&&u<0?(s=it,u=-u,h=-h,d-=u,l-=h):h<0?(s=et,h=-h,l-=h):u<0&&(s=tt,u=-u,d-=u);break;case et:if(c){if(p.y<=0&&(d<=E||l<=b)){A=!1;break}v(De),u-=p.y,d+=p.y,h=u*c,l+=o.width-h}else v(De),v(Ie),p.x<=0?l>b?(h-=p.x,l+=p.x):p.y<=0&&d<=E&&(A=!1):(h-=p.x,l+=p.x),p.y<=0?d>E&&(u-=p.y,d+=p.y):(u-=p.y,d+=p.y);h<0&&u<0?(s=tt,u=-u,h=-h,d-=u,l-=h):h<0?(s=Je,h=-h,l-=h):u<0&&(s=it,u=-u,d-=u);break;case it:if(c){if(p.x<=0&&(l<=b||g>=T)){A=!1;break}v(Ie),h-=p.x,l+=p.x,u=h/c}else v(qe),v(Ie),p.x<=0?l>b?(h-=p.x,l+=p.x):p.y>=0&&g>=T&&(A=!1):(h-=p.x,l+=p.x),p.y>=0?g<T&&(u+=p.y):u+=p.y;h<0&&u<0?(s=Je,u=-u,h=-h,d-=u,l-=h):h<0?(s=tt,h=-h,l-=h):u<0&&(s=et,u=-u,d-=u);break;case tt:if(c){if(p.x>=0&&(f>=S||g>=T)){A=!1;break}v(Fe),h+=p.x,u=h/c}else v(qe),v(Fe),p.x>=0?f<S?h+=p.x:p.y>=0&&g>=T&&(A=!1):h+=p.x,p.y>=0?g<T&&(u+=p.y):u+=p.y;h<0&&u<0?(s=et,u=-u,h=-h,d-=u,l-=h):h<0?(s=it,h=-h,l-=h):u<0&&(s=Je,u=-u,d-=u);break;case Ln:this.move(p.x,p.y),A=!1;break;case Nn:this.zoom(lo(a),e),A=!1;break;case kn:if(!p.x||!p.y){A=!1;break}B=Hn(this.cropper),l=H.startX-B.left,d=H.startY-B.top,h=o.minWidth,u=o.minHeight,p.x>0?s=p.y>0?tt:Je:p.x<0&&(l-=h,s=p.y>0?it:et),p.y<0&&(d-=u),this.cropped||(be(this.cropBox,se),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}A&&(o.width=h,o.height=u,o.left=l,o.top=d,this.action=s,this.renderCropBox()),Z(a,function(D){D.startX=D.endX,D.startY=D.endY})}},So={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&J(this.dragBox,kt),be(this.cropBox,se),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=W({},this.initialImageData),this.canvasData=W({},this.initialCanvasData),this.cropBoxData=W({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(W(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),be(this.dragBox,kt),J(this.cropBox,se)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,Z(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,be(this.cropper,Bi)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,J(this.cropper,Bi)),this},destroy:function(){var e=this.element;return e[Y]?(e[Y]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,r=i.left,o=i.top;return this.moveTo(qt(e)?e:r+Number(e),qt(t)?t:o+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,r=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(R(e)&&(i.left=e,r=!0),R(t)&&(i.top=t,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var r=this.options,o=this.canvasData,a=o.width,s=o.height,c=o.naturalWidth,l=o.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&r.zoomable){var d=c*e,h=l*e;if(Ke(this.element,fi,{ratio:e,oldRatio:a/c,originalEvent:i})===!1)return this;if(i){var u=this.pointers,f=Hn(this.cropper),g=u&&Object.keys(u).length?co(u):{pageX:i.pageX,pageY:i.pageY};o.left-=(d-a)*((g.pageX-f.left-o.left)/a),o.top-=(h-s)*((g.pageY-f.top-o.top)/s)}else We(t)&&R(t.x)&&R(t.y)?(o.left-=(d-a)*((t.x-o.left)/a),o.top-=(h-s)*((t.y-o.top)/s)):(o.left-=(d-a)/2,o.top-=(h-s)/2);o.width=d,o.height=h,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),R(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,R(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(R(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.imageData,r=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(R(e)&&(i.scaleX=e,r=!0),R(t)&&(i.scaleY=t,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,i=this.imageData,r=this.canvasData,o=this.cropBoxData,a;if(this.ready&&this.cropped){a={x:o.left-r.left,y:o.top-r.top,width:o.width,height:o.height};var s=i.width/i.naturalWidth;if(Z(a,function(d,h){a[h]=d/s}),e){var c=Math.round(a.y+a.height),l=Math.round(a.x+a.width);a.x=Math.round(a.x),a.y=Math.round(a.y),a.width=l-a.x,a.height=c-a.y}}else a={x:0,y:0,width:0,height:0};return t.rotatable&&(a.rotate=i.rotate||0),t.scalable&&(a.scaleX=i.scaleX||1,a.scaleY=i.scaleY||1),a},setData:function(e){var t=this.options,i=this.imageData,r=this.canvasData,o={};if(this.ready&&!this.disabled&&We(e)){var a=!1;t.rotatable&&R(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,a=!0),t.scalable&&(R(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,a=!0),R(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,a=!0)),a&&this.renderCanvas(!0,!0);var s=i.width/i.naturalWidth;R(e.x)&&(o.left=e.x*s+r.left),R(e.y)&&(o.top=e.y*s+r.top),R(e.width)&&(o.width=e.width*s),R(e.height)&&(o.height=e.height*s),this.setCropBoxData(o)}return this},getContainerData:function(){return this.ready?W({},this.containerData):{}},getImageData:function(){return this.sized?W({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&Z(["left","top","width","height","naturalWidth","naturalHeight"],function(i){t[i]=e[i]}),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&We(e)&&(R(e.left)&&(t.left=e.left),R(e.top)&&(t.top=e.top),R(e.width)?(t.width=e.width,t.height=e.width/i):R(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,i=this.options.aspectRatio,r,o;return this.ready&&this.cropped&&!this.disabled&&We(e)&&(R(e.left)&&(t.left=e.left),R(e.top)&&(t.top=e.top),R(e.width)&&e.width!==t.width&&(r=!0,t.width=e.width),R(e.height)&&e.height!==t.height&&(o=!0,t.height=e.height),i&&(r?t.height=t.width/i:o&&(t.width=t.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=uo(this.image,this.imageData,t,e);if(!this.cropped)return i;var r=this.getData(e.rounded),o=r.x,a=r.y,s=r.width,c=r.height,l=i.width/Math.floor(t.naturalWidth);l!==1&&(o*=l,a*=l,s*=l,c*=l);var d=s/c,h=Me({aspectRatio:d,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),u=Me({aspectRatio:d,width:e.minWidth||0,height:e.minHeight||0},"cover"),f=Me({aspectRatio:d,width:e.width||(l!==1?i.width:s),height:e.height||(l!==1?i.height:c)}),g=f.width,b=f.height;g=Math.min(h.width,Math.max(u.width,g)),b=Math.min(h.height,Math.max(u.height,b));var E=document.createElement("canvas"),S=E.getContext("2d");E.width=Ge(g),E.height=Ge(b),S.fillStyle=e.fillColor||"transparent",S.fillRect(0,0,g,b);var T=e.imageSmoothingEnabled,A=T===void 0?!0:T,B=e.imageSmoothingQuality;S.imageSmoothingEnabled=A,B&&(S.imageSmoothingQuality=B);var H=i.width,p=i.height,v=o,D=a,x,m,C,_,k,N;v<=-s||v>H?(v=0,x=0,C=0,k=0):v<=0?(C=-v,v=0,x=Math.min(H,s+v),k=x):v<=H&&(C=0,x=Math.min(s,H-v),k=x),x<=0||D<=-c||D>p?(D=0,m=0,_=0,N=0):D<=0?(_=-D,D=0,m=Math.min(p,c+D),N=m):D<=p&&(_=0,m=Math.min(c,p-D),N=m);var F=[v,D,x,m];if(k>0&&N>0){var P=g/s;F.push(C*P,_*P,k*P,N*P)}return S.drawImage.apply(S,[i].concat(Mn(F.map(function(K){return Math.floor(Ge(K))})))),E},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!qt(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,r=this.face;if(this.ready&&!this.disabled){var o=e===Di,a=t.movable&&e===Fn;e=o||a?e:In,t.dragMode=e,pt(i,ut,e),Xe(i,li,o),Xe(i,ci,a),t.cropBoxMovable||(pt(r,ut,e),Xe(r,li,o),Xe(r,ci,a))}return this}},Do=we.Cropper,Yn=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Rr(this,n),!e||!$r.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=W({},Gi,We(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return zr(n,[{key:"init",value:function(){var t=this.element,i=t.tagName.toLowerCase(),r;if(!t[Y]){if(t[Y]=this,i==="img"){if(this.isImg=!0,r=t.getAttribute("src")||"",this.originalUrl=r,!r)return;r=t.src}else i==="canvas"&&window.HTMLCanvasElement&&(r=t.toDataURL());this.load(r)}}},{key:"load",value:function(t){var i=this;if(t){this.url=t,this.imageData={};var r=this.element,o=this.options;if(!o.rotatable&&!o.scalable&&(o.checkOrientation=!1),!o.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Kr.test(t)){Qr.test(t)?this.read(mo(t)):this.clone();return}var a=new XMLHttpRequest,s=this.clone.bind(this);this.reloading=!0,this.xhr=a,a.onabort=s,a.onerror=s,a.ontimeout=s,a.onprogress=function(){a.getResponseHeader("content-type")!==ji&&a.abort()},a.onload=function(){i.read(a.response)},a.onloadend=function(){i.reloading=!1,i.xhr=null},o.checkCrossOrigin&&Qi(t)&&r.crossOrigin&&(t=$i(t)),a.open("GET",t,!0),a.responseType="arraybuffer",a.withCredentials=r.crossOrigin==="use-credentials",a.send()}}},{key:"read",value:function(t){var i=this.options,r=this.imageData,o=vo(t),a=0,s=1,c=1;if(o>1){this.url=go(t,ji);var l=bo(o);a=l.rotate,s=l.scaleX,c=l.scaleY}i.rotatable&&(r.rotate=a),i.scalable&&(r.scaleX=s,r.scaleY=c),this.clone()}},{key:"clone",value:function(){var t=this.element,i=this.url,r=t.crossOrigin,o=i;this.options.checkCrossOrigin&&Qi(i)&&(r||(r="anonymous"),o=$i(i)),this.crossOrigin=r,this.crossOriginUrl=o;var a=document.createElement("img");r&&(a.crossOrigin=r),a.src=o||i,a.alt=t.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),J(a,Pi),t.parentNode.insertBefore(a,t.nextSibling)}},{key:"start",value:function(){var t=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var r=we.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(we.navigator.userAgent),o=function(l,d){W(t.imageData,{naturalWidth:l,naturalHeight:d,aspectRatio:l/d}),t.initialImageData=W({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(i.naturalWidth&&!r){o(i.naturalWidth,i.naturalHeight);return}var a=document.createElement("img"),s=document.body||document.documentElement;this.sizingImage=a,a.onload=function(){o(a.width,a.height),r||s.removeChild(a)},a.src=i.src,r||(a.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",s.appendChild(a))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,i=this.options,r=this.image,o=t.parentNode,a=document.createElement("div");a.innerHTML=Zr;var s=a.querySelector(".".concat(Y,"-container")),c=s.querySelector(".".concat(Y,"-canvas")),l=s.querySelector(".".concat(Y,"-drag-box")),d=s.querySelector(".".concat(Y,"-crop-box")),h=d.querySelector(".".concat(Y,"-face"));this.container=o,this.cropper=s,this.canvas=c,this.dragBox=l,this.cropBox=d,this.viewBox=s.querySelector(".".concat(Y,"-view-box")),this.face=h,c.appendChild(r),J(t,se),o.insertBefore(s,t.nextSibling),be(r,Pi),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,J(d,se),i.guides||J(d.getElementsByClassName("".concat(Y,"-dashed")),se),i.center||J(d.getElementsByClassName("".concat(Y,"-center")),se),i.background&&J(s,"".concat(Y,"-bg")),i.highlight||J(h,Wr),i.cropBoxMovable&&(J(h,ci),pt(h,ut,Si)),i.cropBoxResizable||(J(d.getElementsByClassName("".concat(Y,"-line")),se),J(d.getElementsByClassName("".concat(Y,"-point")),se)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),ae(i.ready)&&ue(t,Wi,i.ready,{once:!0}),Ke(t,Wi)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),be(this.element,se)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Do,n}},{key:"setDefaults",value:function(t){W(Gi,We(t)&&t)}}]),n}();W(Yn.prototype,yo,wo,Eo,_o,Co,So);var Wn={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(he,function(){var t=!1;function i(o){this.opts=function(){for(var a=1;a<arguments.length;a++)for(var s in arguments[a])arguments[a].hasOwnProperty(s)&&(arguments[0][s]=arguments[a][s]);return arguments[0]}({},{onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,stickyFooter:!1,footer:!1,cssClass:[],closeLabel:"Close",closeMethods:["overlay","button","escape"]},o),this.init()}function r(){this.modalBoxFooter&&(this.modalBoxFooter.style.width=this.modalBox.clientWidth+"px",this.modalBoxFooter.style.left=this.modalBox.offsetLeft+"px")}return i.prototype.init=function(){if(!this.modal)return(function(){this.modal=document.createElement("div"),this.modal.classList.add("tingle-modal"),this.opts.closeMethods.length!==0&&this.opts.closeMethods.indexOf("overlay")!==-1||this.modal.classList.add("tingle-modal--noOverlayClose"),this.modal.style.display="none",this.opts.cssClass.forEach(function(o){typeof o=="string"&&this.modal.classList.add(o)},this),this.opts.closeMethods.indexOf("button")!==-1&&(this.modalCloseBtn=document.createElement("button"),this.modalCloseBtn.type="button",this.modalCloseBtn.classList.add("tingle-modal__close"),this.modalCloseBtnIcon=document.createElement("span"),this.modalCloseBtnIcon.classList.add("tingle-modal__closeIcon"),this.modalCloseBtnIcon.innerHTML='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.3 9.7c.2.2.4.3.7.3.3 0 .5-.1.7-.3L5 6.4l3.3 3.3c.2.2.5.3.7.3.2 0 .5-.1.7-.3.4-.4.4-1 0-1.4L6.4 5l3.3-3.3c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L5 3.6 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4L3.6 5 .3 8.3c-.4.4-.4 1 0 1.4z" fill="#000" fill-rule="nonzero"/></svg>',this.modalCloseBtnLabel=document.createElement("span"),this.modalCloseBtnLabel.classList.add("tingle-modal__closeLabel"),this.modalCloseBtnLabel.innerHTML=this.opts.closeLabel,this.modalCloseBtn.appendChild(this.modalCloseBtnIcon),this.modalCloseBtn.appendChild(this.modalCloseBtnLabel)),this.modalBox=document.createElement("div"),this.modalBox.classList.add("tingle-modal-box"),this.modalBoxContent=document.createElement("div"),this.modalBoxContent.classList.add("tingle-modal-box__content"),this.modalBox.appendChild(this.modalBoxContent),this.opts.closeMethods.indexOf("button")!==-1&&this.modal.appendChild(this.modalCloseBtn),this.modal.appendChild(this.modalBox)}).call(this),(function(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:(function(o){var a=this.modal.offsetWidth-this.modal.clientWidth,s=o.clientX>=this.modal.offsetWidth-15,c=this.modal.scrollHeight!==this.modal.offsetHeight;navigator.platform==="MacIntel"&&a==0&&s&&c||this.opts.closeMethods.indexOf("overlay")!==-1&&!function(l,d){for(;(l=l.parentElement)&&!l.classList.contains(d););return l}(o.target,"tingle-modal")&&o.clientX<this.modal.clientWidth&&this.close()}).bind(this),resize:this.checkOverflow.bind(this),keyboardNav:(function(o){this.opts.closeMethods.indexOf("escape")!==-1&&o.which===27&&this.isOpen()&&this.close()}).bind(this)},this.opts.closeMethods.indexOf("button")!==-1&&this.modalCloseBtn.addEventListener("click",this._events.clickCloseBtn),this.modal.addEventListener("mousedown",this._events.clickOverlay),window.addEventListener("resize",this._events.resize),document.addEventListener("keydown",this._events.keyboardNav)}).call(this),document.body.appendChild(this.modal,document.body.firstChild),this.opts.footer&&this.addFooter(),this},i.prototype._busy=function(o){t=o},i.prototype._isBusy=function(){return t},i.prototype.destroy=function(){this.modal!==null&&(this.isOpen()&&this.close(!0),(function(){this.opts.closeMethods.indexOf("button")!==-1&&this.modalCloseBtn.removeEventListener("click",this._events.clickCloseBtn),this.modal.removeEventListener("mousedown",this._events.clickOverlay),window.removeEventListener("resize",this._events.resize),document.removeEventListener("keydown",this._events.keyboardNav)}).call(this),this.modal.parentNode.removeChild(this.modal),this.modal=null)},i.prototype.isOpen=function(){return!!this.modal.classList.contains("tingle-modal--visible")},i.prototype.open=function(){if(!this._isBusy()){this._busy(!0);var o=this;return typeof o.opts.beforeOpen=="function"&&o.opts.beforeOpen(),this.modal.style.removeProperty?this.modal.style.removeProperty("display"):this.modal.style.removeAttribute("display"),document.getSelection().removeAllRanges(),this._scrollPosition=window.pageYOffset,document.body.classList.add("tingle-enabled"),document.body.style.top=-this._scrollPosition+"px",this.setStickyFooter(this.opts.stickyFooter),this.modal.classList.add("tingle-modal--visible"),typeof o.opts.onOpen=="function"&&o.opts.onOpen.call(o),o._busy(!1),this.checkOverflow(),this}},i.prototype.close=function(o){if(!this._isBusy()){if(this._busy(!0),typeof this.opts.beforeClose=="function"&&!this.opts.beforeClose.call(this))return void this._busy(!1);document.body.classList.remove("tingle-enabled"),document.body.style.top=null,window.scrollTo({top:this._scrollPosition,behavior:"instant"}),this.modal.classList.remove("tingle-modal--visible");var a=this;a.modal.style.display="none",typeof a.opts.onClose=="function"&&a.opts.onClose.call(this),a._busy(!1)}},i.prototype.setContent=function(o){return typeof o=="string"?this.modalBoxContent.innerHTML=o:(this.modalBoxContent.innerHTML="",this.modalBoxContent.appendChild(o)),this.isOpen()&&this.checkOverflow(),this},i.prototype.getContent=function(){return this.modalBoxContent},i.prototype.addFooter=function(){return(function(){this.modalBoxFooter=document.createElement("div"),this.modalBoxFooter.classList.add("tingle-modal-box__footer"),this.modalBox.appendChild(this.modalBoxFooter)}).call(this),this},i.prototype.setFooterContent=function(o){return this.modalBoxFooter.innerHTML=o,this},i.prototype.getFooterContent=function(){return this.modalBoxFooter},i.prototype.setStickyFooter=function(o){return this.isOverflow()||(o=!1),o?this.modalBox.contains(this.modalBoxFooter)&&(this.modalBox.removeChild(this.modalBoxFooter),this.modal.appendChild(this.modalBoxFooter),this.modalBoxFooter.classList.add("tingle-modal-box__footer--sticky"),r.call(this),this.modalBoxContent.style["padding-bottom"]=this.modalBoxFooter.clientHeight+20+"px"):this.modalBoxFooter&&(this.modalBox.contains(this.modalBoxFooter)||(this.modal.removeChild(this.modalBoxFooter),this.modalBox.appendChild(this.modalBoxFooter),this.modalBoxFooter.style.width="auto",this.modalBoxFooter.style.left="",this.modalBoxContent.style["padding-bottom"]="",this.modalBoxFooter.classList.remove("tingle-modal-box__footer--sticky"))),this},i.prototype.addFooterBtn=function(o,a,s){var c=document.createElement("button");return c.innerHTML=o,c.addEventListener("click",s),typeof a=="string"&&a.length&&a.split(" ").forEach(function(l){c.classList.add(l)}),this.modalBoxFooter.appendChild(c),c},i.prototype.resize=function(){console.warn("Resize is deprecated and will be removed in version 1.0")},i.prototype.isOverflow=function(){return window.innerHeight<=this.modalBox.clientHeight},i.prototype.checkOverflow=function(){this.modal.classList.contains("tingle-modal--visible")&&(this.isOverflow()?this.modal.classList.add("tingle-modal--overflow"):this.modal.classList.remove("tingle-modal--overflow"),!this.isOverflow()&&this.opts.stickyFooter?this.setStickyFooter(!1):this.isOverflow()&&this.opts.stickyFooter&&(r.call(this),this.setStickyFooter(!0)))},{modal:i}})})(Wn);var xo=Wn.exports;const To=fr(xo);class gi extends window.Controller{connect(){let e=this.data.get("url")?this.data.get("url"):this.data.get("value");const t=this.element.querySelector(".cropper-preview"),i=this.element.querySelector(".cropper-remove");e?t.src=e:(t.classList.add("none"),i.classList.add("none"))}getModal(){const{width:e,height:t}=this.data.get,i=`
            <div class="modal-to-clone" role="dialog">
                <div class="modal-dialog modal-fullscreen-md-down modal-lg">
                    <div class="modal-content-wrapper">
                        <div class="modal-content">
                            <div class="position-relative">
                                <img class="upload-panel">
                            </div>
                        </div>
                    </div>
                </div>
                </div>`;return this.modal=new To.modal({footer:!0,stickyFooter:!1,closeMethods:["overlay"],closeLabel:"Close",cssClass:["custom-class-1","custom-class-2"],onOpen:function(){this.setContent(i);let r=document.querySelector(".upload-panel");r.width=e,r.height=t,window.cropper=new Yn(r,{viewMode:2,aspectRatio:e/t,minContainerHeight:500})},onClose:function(){this.destroy()},beforeClose:function(){return!0}}),this.modal.addFooterBtn("Закрыть","btn btn-link",()=>{this.modal.close()}),this.modal.addFooterBtn("Обрезать","btn btn-default",()=>{this.crop(this.modal)}),this.clearEvent(),this.modal}async upload(e){const t=this.data.get("max-file-size");if(t!==null&&e.target.files[0].size/1024/1024>t){this.alert("Validation error",`The download file is too large. Max size: ${t} MB`),e.target.value=null;return}this.selected=e.target.closest(".cropper-parent"),this.getModal().open();let i=new FileReader;i.readAsDataURL(e.target.files[0]),await new Promise(r=>{i.onloadend=()=>{window.cropper.replace(i.result),r()}}),document.querySelector(".cropper-path").dispatchEvent(new Event("change"))}crop(e){window.cropper.getCroppedCanvas().toBlob(t=>{const i=new FormData;i.append("file",t),i.append("storage",this.data.get("storage")),i.append("group",this.data.get("groups")),i.append("path",this.data.get("path")),i.append("acceptedFiles",this.data.get("accepted-files")),i.append("width",this.data.get("width")),i.append("height",this.data.get("height")),window.axios.post(this.prefix("/systems/files"),i).then(r=>{let o=r.data.url,a=this.data.get("target");this.selected.querySelector(".cropper-preview").src=o,this.selected.querySelector(".cropper-preview").classList.remove("none"),this.selected.querySelector(".cropper-remove").classList.remove("none"),this.selected.querySelector(".cropper-path").value=r.data[a],this.selected.querySelector(".cropper-path").dispatchEvent(new Event("change")),e.close(),this.selected=null}).catch(r=>{this.alert("Validation error","File upload error"),console.warn(r)})})}clear(e){this.selected=e.target.closest(".cropper-parent"),this.selected&&(this.selected.querySelector(".cropper-path").value="",this.selected.querySelector(".cropper-preview").src="",this.selected.querySelector(".cropper-preview").classList.add("none"),this.selected.querySelector(".cropper-remove").classList.add("none")),this.selected=null}clearEvent(){document.querySelector(".tingle-modal").querySelector(".btn.btn-link").addEventListener("click",i=>{this.clear(i)}),window.addEventListener("click",i=>{i.target.closest(".tingle-modal")||this.clear(i)})}moveleft(){this.cropper.move(-10,0)}moveright(){this.cropper.move(10,0)}moveup(){this.cropper.move(0,-10)}movedown(){this.cropper.move(0,10)}zoomin(){this.cropper.zoom(.1)}zoomout(){this.cropper.zoom(-.1)}rotateleft(){this.cropper.rotate(-5)}rotateright(){this.cropper.rotate(5)}scalex(){const e=this.element.querySelector(".cropper-dataScaleX");this.cropper.scaleX(-e.value)}scaley(){const e=this.element.querySelector(".cropper-dataScaleY");this.cropper.scaleY(-e.value)}aspectratiowh(){this.cropper.setAspectRatio(this.data.get("width")/this.data.get("height"))}aspectratiofree(){this.cropper.setAspectRatio(NaN)}}Ze(gi,"selected",null),Ze(gi,"targets",["source","upload"]);class Ao extends window.Controller{constructor(){super(...arguments);Ze(this,"example_image_upload_handler",(t,i)=>new Promise((r,o)=>{const a=new XMLHttpRequest;let s=function(d){let u=`${document.head.querySelector('meta[name="dashboard-prefix"]').content}${d}`.replace(/\/\/+/g,"/");return`${location.protocol}//${location.hostname}${location.port?`:${location.port}`:""}${u}`},c=document.head.querySelector('meta[name="csrf_token"]').getAttribute("content");a.withCredentials=!1,a.open("POST",s("/systems/files")),a.upload.onprogress=d=>{i(d.loaded/d.total*100)},a.onload=()=>{if(a.status===403){o({message:"HTTP Error: "+a.status,remove:!0});return}if(a.status<200||a.status>=300){o("HTTP Error: "+a.status);return}const d=JSON.parse(a.responseText);if(d.location=d.relativeUrl,!d||typeof d.location!="string"){o("Invalid JSON: "+a.responseText);return}r(d.location)},a.onerror=()=>{o("Image upload failed due to a XHR Transport error. Code: "+a.status)};const l=new FormData;l.append("_token",c),l.append("file",t.blob(),t.filename()),a.send(l)}))}connect(){const t="#"+this.element.querySelector(".tinymce").id;tinymce.remove(t),tinymce.init({selector:t,language:this.element.dataset.language,plugins:"preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons",toolbar:"undo redo bold italic underline strikethrough fontfamily fontsize blocks alignleft aligncenter alignright alignjustify outdent indent  numlist bullist forecolor backcolor removeformat pagebreak charmap emoticons fullscreen code preview print insertfile image media link anchor codesample ltr rtl",menubar:!1,table_header_type:"section",images_upload_handler:this.example_image_upload_handler})}disconnect(t){tinymce.remove(t)}}var Zi=Xn;function Xn(){var n=[].slice.call(arguments),e=!1;typeof n[0]=="boolean"&&(e=n.shift());var t=n[0];if(Ji(t))throw new Error("extendee must be an object");for(var i=n.slice(1),r=i.length,o=0;o<r;o++){var a=i[o];for(var s in a)if(Object.prototype.hasOwnProperty.call(a,s)){var c=a[s];if(e&&Mo(c)){var l=Array.isArray(c)?[]:{};t[s]=Xn(!0,Object.prototype.hasOwnProperty.call(t,s)&&!Ji(t[s])?t[s]:l,c)}else t[s]=c}}return t}function Mo(n){return Array.isArray(n)||{}.toString.call(n)=="[object Object]"}function Ji(n){return!n||typeof n!="object"&&typeof n!="function"}function Oo(n){return n&&n.__esModule?n.default:n}class en{on(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}emit(e,...t){this._callbacks=this._callbacks||{};let i=this._callbacks[e];if(i)for(let r of i)r.apply(this,t);return this.element&&this.element.dispatchEvent(this.makeEvent("dropzone:"+e,{args:t})),this}makeEvent(e,t){let i={bubbles:!0,cancelable:!0,detail:t};if(typeof window.CustomEvent=="function")return new CustomEvent(e,i);var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,i.bubbles,i.cancelable,i.detail),r}off(e,t){if(!this._callbacks||arguments.length===0)return this._callbacks={},this;let i=this._callbacks[e];if(!i)return this;if(arguments.length===1)return delete this._callbacks[e],this;for(let r=0;r<i.length;r++)if(i[r]===t){i.splice(r,1);break}return this}}var Vn={};Vn=`<div class="dz-preview dz-file-preview">
  <div class="dz-image"><img data-dz-thumbnail=""></div>
  <div class="dz-details">
    <div class="dz-size"><span data-dz-size=""></span></div>
    <div class="dz-filename"><span data-dz-name=""></span></div>
  </div>
  <div class="dz-progress">
    <span class="dz-upload" data-dz-uploadprogress=""></span>
  </div>
  <div class="dz-error-message"><span data-dz-errormessage=""></span></div>
  <div class="dz-success-mark">
    <svg width="54" height="54" viewBox="0 0 54 54" fill="white" xmlns="http://www.w3.org/2000/svg">
      <path d="M10.2071 29.7929L14.2929 25.7071C14.6834 25.3166 15.3166 25.3166 15.7071 25.7071L21.2929 31.2929C21.6834 31.6834 22.3166 31.6834 22.7071 31.2929L38.2929 15.7071C38.6834 15.3166 39.3166 15.3166 39.7071 15.7071L43.7929 19.7929C44.1834 20.1834 44.1834 20.8166 43.7929 21.2071L22.7071 42.2929C22.3166 42.6834 21.6834 42.6834 21.2929 42.2929L10.2071 31.2071C9.81658 30.8166 9.81658 30.1834 10.2071 29.7929Z"></path>
    </svg>
  </div>
  <div class="dz-error-mark">
    <svg width="54" height="54" viewBox="0 0 54 54" fill="white" xmlns="http://www.w3.org/2000/svg">
      <path d="M26.2929 20.2929L19.2071 13.2071C18.8166 12.8166 18.1834 12.8166 17.7929 13.2071L13.2071 17.7929C12.8166 18.1834 12.8166 18.8166 13.2071 19.2071L20.2929 26.2929C20.6834 26.6834 20.6834 27.3166 20.2929 27.7071L13.2071 34.7929C12.8166 35.1834 12.8166 35.8166 13.2071 36.2071L17.7929 40.7929C18.1834 41.1834 18.8166 41.1834 19.2071 40.7929L26.2929 33.7071C26.6834 33.3166 27.3166 33.3166 27.7071 33.7071L34.7929 40.7929C35.1834 41.1834 35.8166 41.1834 36.2071 40.7929L40.7929 36.2071C41.1834 35.8166 41.1834 35.1834 40.7929 34.7929L33.7071 27.7071C33.3166 27.3166 33.3166 26.6834 33.7071 26.2929L40.7929 19.2071C41.1834 18.8166 41.1834 18.1834 40.7929 17.7929L36.2071 13.2071C35.8166 12.8166 35.1834 12.8166 34.7929 13.2071L27.7071 20.2929C27.3166 20.6834 26.6834 20.6834 26.2929 20.2929Z"></path>
    </svg>
  </div>
</div>
`;let ko={url:null,method:"post",withCredentials:!1,timeout:null,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2097152,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,defaultHeaders:!0,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,disablePreviews:!1,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init(){},params(n,e,t){if(t)return{dzuuid:t.file.upload.uuid,dzchunkindex:t.index,dztotalfilesize:t.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:t.file.upload.totalChunkCount,dzchunkbyteoffset:t.index*this.options.chunkSize}},accept(n,e){return e()},chunksUploaded:function(n,e){e()},binaryBody:!1,fallback(){let n;this.element.className=`${this.element.className} dz-browser-not-supported`;for(let t of this.element.getElementsByTagName("div"))if(/(^| )dz-message($| )/.test(t.className)){n=t,t.className="dz-message";break}n||(n=y.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(n));let e=n.getElementsByTagName("span")[0];return e&&(e.textContent!=null?e.textContent=this.options.dictFallbackMessage:e.innerText!=null&&(e.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize(n,e,t,i){let r={srcX:0,srcY:0,srcWidth:n.width,srcHeight:n.height},o=n.width/n.height;e==null&&t==null?(e=r.srcWidth,t=r.srcHeight):e==null?e=t*o:t==null&&(t=e/o),e=Math.min(e,r.srcWidth),t=Math.min(t,r.srcHeight);let a=e/t;if(r.srcWidth>e||r.srcHeight>t)if(i==="crop")o>a?(r.srcHeight=n.height,r.srcWidth=r.srcHeight*a):(r.srcWidth=n.width,r.srcHeight=r.srcWidth/a);else if(i==="contain")o>a?t=e/o:e=t*o;else throw new Error(`Unknown resizeMethod '${i}'`);return r.srcX=(n.width-r.srcWidth)/2,r.srcY=(n.height-r.srcHeight)/2,r.trgWidth=e,r.trgHeight=t,r},transformFile(n,e){return(this.options.resizeWidth||this.options.resizeHeight)&&n.type.match(/image.*/)?this.resizeImage(n,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,e):e(n)},previewTemplate:Oo(Vn),drop(n){return this.element.classList.remove("dz-drag-hover")},dragstart(n){},dragend(n){return this.element.classList.remove("dz-drag-hover")},dragenter(n){return this.element.classList.add("dz-drag-hover")},dragover(n){return this.element.classList.add("dz-drag-hover")},dragleave(n){return this.element.classList.remove("dz-drag-hover")},paste(n){},reset(){return this.element.classList.remove("dz-started")},addedfile(n){if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer&&!this.options.disablePreviews){n.previewElement=y.createElement(this.options.previewTemplate.trim()),n.previewTemplate=n.previewElement,this.previewsContainer.appendChild(n.previewElement);for(var e of n.previewElement.querySelectorAll("[data-dz-name]"))e.textContent=n.name;for(e of n.previewElement.querySelectorAll("[data-dz-size]"))e.innerHTML=this.filesize(n.size);this.options.addRemoveLinks&&(n._removeLink=y.createElement(`<a class="dz-remove" href="javascript:undefined;" data-dz-remove>${this.options.dictRemoveFile}</a>`),n.previewElement.appendChild(n._removeLink));let t=i=>(i.preventDefault(),i.stopPropagation(),n.status===y.UPLOADING?y.confirm(this.options.dictCancelUploadConfirmation,()=>this.removeFile(n)):this.options.dictRemoveFileConfirmation?y.confirm(this.options.dictRemoveFileConfirmation,()=>this.removeFile(n)):this.removeFile(n));for(let i of n.previewElement.querySelectorAll("[data-dz-remove]"))i.addEventListener("click",t)}},removedfile(n){return n.previewElement!=null&&n.previewElement.parentNode!=null&&n.previewElement.parentNode.removeChild(n.previewElement),this._updateMaxFilesReachedClass()},thumbnail(n,e){if(n.previewElement){n.previewElement.classList.remove("dz-file-preview");for(let t of n.previewElement.querySelectorAll("[data-dz-thumbnail]"))t.alt=n.name,t.src=e;return setTimeout(()=>n.previewElement.classList.add("dz-image-preview"),1)}},error(n,e){if(n.previewElement){n.previewElement.classList.add("dz-error"),typeof e!="string"&&e.error&&(e=e.error);for(let t of n.previewElement.querySelectorAll("[data-dz-errormessage]"))t.textContent=e}},errormultiple(){},processing(n){if(n.previewElement&&(n.previewElement.classList.add("dz-processing"),n._removeLink))return n._removeLink.innerHTML=this.options.dictCancelUpload},processingmultiple(){},uploadprogress(n,e,t){if(n.previewElement)for(let i of n.previewElement.querySelectorAll("[data-dz-uploadprogress]"))i.nodeName==="PROGRESS"?i.value=e:i.style.width=`${e}%`},totaluploadprogress(){},sending(){},sendingmultiple(){},success(n){if(n.previewElement)return n.previewElement.classList.add("dz-success")},successmultiple(){},canceled(n){return this.emit("error",n,this.options.dictUploadCanceled)},canceledmultiple(){},complete(n){if(n._removeLink&&(n._removeLink.innerHTML=this.options.dictRemoveFile),n.previewElement)return n.previewElement.classList.add("dz-complete")},completemultiple(){},maxfilesexceeded(){},maxfilesreached(){},queuecomplete(){},addedfiles(){}};var Lo=ko;class y extends en{static initClass(){this.prototype.Emitter=en,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}getAcceptedFiles(){return this.files.filter(e=>e.accepted).map(e=>e)}getRejectedFiles(){return this.files.filter(e=>!e.accepted).map(e=>e)}getFilesWithStatus(e){return this.files.filter(t=>t.status===e).map(t=>t)}getQueuedFiles(){return this.getFilesWithStatus(y.QUEUED)}getUploadingFiles(){return this.getFilesWithStatus(y.UPLOADING)}getAddedFiles(){return this.getFilesWithStatus(y.ADDED)}getActiveFiles(){return this.files.filter(e=>e.status===y.UPLOADING||e.status===y.QUEUED).map(e=>e)}init(){if(this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(y.createElement(`<div class="dz-default dz-message"><button class="dz-button" type="button">${this.options.dictDefaultMessage}</button></div>`)),this.clickableElements.length){let i=()=>{this.hiddenFileInput&&this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=document.createElement("input"),this.hiddenFileInput.setAttribute("type","file"),(this.options.maxFiles===null||this.options.maxFiles>1)&&this.hiddenFileInput.setAttribute("multiple","multiple"),this.hiddenFileInput.className="dz-hidden-input",this.options.acceptedFiles!==null&&this.hiddenFileInput.setAttribute("accept",this.options.acceptedFiles),this.options.capture!==null&&this.hiddenFileInput.setAttribute("capture",this.options.capture),this.hiddenFileInput.setAttribute("tabindex","-1"),this.hiddenFileInput.style.visibility="hidden",this.hiddenFileInput.style.position="absolute",this.hiddenFileInput.style.top="0",this.hiddenFileInput.style.left="0",this.hiddenFileInput.style.height="0",this.hiddenFileInput.style.width="0",y.getElement(this.options.hiddenInputContainer,"hiddenInputContainer").appendChild(this.hiddenFileInput),this.hiddenFileInput.addEventListener("change",()=>{let{files:r}=this.hiddenFileInput;if(r.length)for(let o of r)this.addFile(o);this.emit("addedfiles",r),i()})};i()}this.URL=window.URL!==null?window.URL:window.webkitURL;for(let i of this.events)this.on(i,this.options[i]);this.on("uploadprogress",()=>this.updateTotalUploadProgress()),this.on("removedfile",()=>this.updateTotalUploadProgress()),this.on("canceled",i=>this.emit("complete",i)),this.on("complete",i=>{if(this.getAddedFiles().length===0&&this.getUploadingFiles().length===0&&this.getQueuedFiles().length===0)return setTimeout(()=>this.emit("queuecomplete"),0)});const e=function(i){if(i.dataTransfer.types){for(var r=0;r<i.dataTransfer.types.length;r++)if(i.dataTransfer.types[r]==="Files")return!0}return!1};let t=function(i){if(e(i))return i.stopPropagation(),i.preventDefault?i.preventDefault():i.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:i=>this.emit("dragstart",i),dragenter:i=>(t(i),this.emit("dragenter",i)),dragover:i=>{let r;try{r=i.dataTransfer.effectAllowed}catch{}return i.dataTransfer.dropEffect=r==="move"||r==="linkMove"?"move":"copy",t(i),this.emit("dragover",i)},dragleave:i=>this.emit("dragleave",i),drop:i=>(t(i),this.drop(i)),dragend:i=>this.emit("dragend",i)}}],this.clickableElements.forEach(i=>this.listeners.push({element:i,events:{click:r=>((i!==this.element||r.target===this.element||y.elementInside(r.target,this.element.querySelector(".dz-message")))&&this.hiddenFileInput.click(),!0)}})),this.enable(),this.options.init.call(this)}destroy(){return this.disable(),this.removeAllFiles(!0),this.hiddenFileInput!=null&&this.hiddenFileInput.parentNode&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,y.instances.splice(y.instances.indexOf(this),1)}updateTotalUploadProgress(){let e,t=0,i=0;if(this.getActiveFiles().length){for(let o of this.getActiveFiles())t+=o.upload.bytesSent,i+=o.upload.total;e=100*t/i}else e=100;return this.emit("totaluploadprogress",e,i,t)}_getParamName(e){return typeof this.options.paramName=="function"?this.options.paramName(e):`${this.options.paramName}${this.options.uploadMultiple?`[${e}]`:""}`}_renameFile(e){return typeof this.options.renameFile!="function"?e.name:this.options.renameFile(e)}getFallbackForm(){let e,t;if(e=this.getExistingFallback())return e;let i='<div class="dz-fallback">';this.options.dictFallbackText&&(i+=`<p>${this.options.dictFallbackText}</p>`),i+=`<input type="file" name="${this._getParamName(0)}" ${this.options.uploadMultiple?'multiple="multiple"':void 0} /><input type="submit" value="Upload!"></div>`;let r=y.createElement(i);return this.element.tagName!=="FORM"?(t=y.createElement(`<form action="${this.options.url}" enctype="multipart/form-data" method="${this.options.method}"></form>`),t.appendChild(r)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),t??r}getExistingFallback(){let e=function(i){for(let r of i)if(/(^| )fallback($| )/.test(r.className))return r};for(let i of["div","form"]){var t;if(t=e(this.element.getElementsByTagName(i)))return t}}setupEventListeners(){return this.listeners.map(e=>(()=>{let t=[];for(let i in e.events){let r=e.events[i];t.push(e.element.addEventListener(i,r,!1))}return t})())}removeEventListeners(){return this.listeners.map(e=>(()=>{let t=[];for(let i in e.events){let r=e.events[i];t.push(e.element.removeEventListener(i,r,!1))}return t})())}disable(){return this.clickableElements.forEach(e=>e.classList.remove("dz-clickable")),this.removeEventListeners(),this.disabled=!0,this.files.map(e=>this.cancelUpload(e))}enable(){return delete this.disabled,this.clickableElements.forEach(e=>e.classList.add("dz-clickable")),this.setupEventListeners()}filesize(e){let t=0,i="b";if(e>0){let r=["tb","gb","mb","kb","b"];for(let o=0;o<r.length;o++){let a=r[o],s=Math.pow(this.options.filesizeBase,4-o)/10;if(e>=s){t=e/Math.pow(this.options.filesizeBase,4-o),i=a;break}}t=Math.round(10*t)/10}return`<strong>${t}</strong> ${this.options.dictFileSizeUnits[i]}`}_updateMaxFilesReachedClass(){return this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}drop(e){if(!e.dataTransfer)return;this.emit("drop",e);let t=[];for(let i=0;i<e.dataTransfer.files.length;i++)t[i]=e.dataTransfer.files[i];if(t.length){let{items:i}=e.dataTransfer;i&&i.length&&i[0].webkitGetAsEntry!=null?this._addFilesFromItems(i):this.handleFiles(t)}this.emit("addedfiles",t)}paste(e){if(zo(e!=null?e.clipboardData:void 0,i=>i.items)==null)return;this.emit("paste",e);let{items:t}=e.clipboardData;if(t.length)return this._addFilesFromItems(t)}handleFiles(e){for(let t of e)this.addFile(t)}_addFilesFromItems(e){return(()=>{let t=[];for(let r of e){var i;r.webkitGetAsEntry!=null&&(i=r.webkitGetAsEntry())?i.isFile?t.push(this.addFile(r.getAsFile())):i.isDirectory?t.push(this._addFilesFromDirectory(i,i.name)):t.push(void 0):r.getAsFile!=null&&(r.kind==null||r.kind==="file")?t.push(this.addFile(r.getAsFile())):t.push(void 0)}return t})()}_addFilesFromDirectory(e,t){let i=e.createReader(),r=a=>Bo(console,"log",s=>s.log(a));var o=()=>i.readEntries(a=>{if(a.length>0){for(let s of a)s.isFile?s.file(c=>{if(!(this.options.ignoreHiddenFiles&&c.name.substring(0,1)==="."))return c.fullPath=`${t}/${c.name}`,this.addFile(c)}):s.isDirectory&&this._addFilesFromDirectory(s,`${t}/${s.name}`);o()}return null},r);return o()}accept(e,t){this.options.maxFilesize&&e.size>this.options.maxFilesize*1048576?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):y.isValidFile(e,this.options.acceptedFiles)?this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)}addFile(e){e.upload={uuid:y.uuidv4(),progress:0,total:e.size,bytesSent:0,filename:this._renameFile(e)},this.files.push(e),e.status=y.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,t=>{t?(e.accepted=!1,this._errorProcessing([e],t)):(e.accepted=!0,this.options.autoQueue&&this.enqueueFile(e)),this._updateMaxFilesReachedClass()})}enqueueFiles(e){for(let t of e)this.enqueueFile(t);return null}enqueueFile(e){if(e.status===y.ADDED&&e.accepted===!0){if(e.status=y.QUEUED,this.options.autoProcessQueue)return setTimeout(()=>this.processQueue(),0)}else throw new Error("This file can't be queued because it has already been processed or was rejected.")}_enqueueThumbnail(e){if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=this.options.maxThumbnailFilesize*1048576)return this._thumbnailQueue.push(e),setTimeout(()=>this._processThumbnailQueue(),0)}_processThumbnailQueue(){if(this._processingThumbnail||this._thumbnailQueue.length===0)return;this._processingThumbnail=!0;let e=this._thumbnailQueue.shift();return this.createThumbnail(e,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,t=>(this.emit("thumbnail",e,t),this._processingThumbnail=!1,this._processThumbnailQueue()))}removeFile(e){if(e.status===y.UPLOADING&&this.cancelUpload(e),this.files=No(this.files,e),this.emit("removedfile",e),this.files.length===0)return this.emit("reset")}removeAllFiles(e){e==null&&(e=!1);for(let t of this.files.slice())(t.status!==y.UPLOADING||e)&&this.removeFile(t);return null}resizeImage(e,t,i,r,o){return this.createThumbnail(e,t,i,r,!0,(a,s)=>{if(s==null)return o(e);{let{resizeMimeType:c}=this.options;c==null&&(c=e.type);let l=s.toDataURL(c,this.options.resizeQuality);return(c==="image/jpeg"||c==="image/jpg")&&(l=jn.restore(e.dataURL,l)),o(y.dataURItoBlob(l))}})}createThumbnail(e,t,i,r,o,a){let s=new FileReader;s.onload=()=>{if(e.dataURL=s.result,e.type==="image/svg+xml"){a!=null&&a(s.result);return}this.createThumbnailFromUrl(e,t,i,r,o,a)},s.readAsDataURL(e)}displayExistingFile(e,t,i,r,o=!0){if(this.emit("addedfile",e),this.emit("complete",e),!o)this.emit("thumbnail",e,t),i&&i();else{let a=s=>{this.emit("thumbnail",e,s),i&&i()};e.dataURL=t,this.createThumbnailFromUrl(e,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,this.options.fixOrientation,a,r)}}createThumbnailFromUrl(e,t,i,r,o,a,s){let c=document.createElement("img");return s&&(c.crossOrigin=s),o=getComputedStyle(document.body).imageOrientation=="from-image"?!1:o,c.onload=()=>{let l=d=>d(1);return typeof EXIF<"u"&&EXIF!==null&&o&&(l=d=>EXIF.getData(c,function(){return d(EXIF.getTag(this,"Orientation"))})),l(d=>{e.width=c.width,e.height=c.height;let h=this.options.resize.call(this,e,t,i,r),u=document.createElement("canvas"),f=u.getContext("2d");switch(u.width=h.trgWidth,u.height=h.trgHeight,d>4&&(u.width=h.trgHeight,u.height=h.trgWidth),d){case 2:f.translate(u.width,0),f.scale(-1,1);break;case 3:f.translate(u.width,u.height),f.rotate(Math.PI);break;case 4:f.translate(0,u.height),f.scale(1,-1);break;case 5:f.rotate(.5*Math.PI),f.scale(1,-1);break;case 6:f.rotate(.5*Math.PI),f.translate(0,-u.width);break;case 7:f.rotate(.5*Math.PI),f.translate(u.height,-u.width),f.scale(-1,1);break;case 8:f.rotate(-.5*Math.PI),f.translate(-u.height,0);break}Ro(f,c,h.srcX!=null?h.srcX:0,h.srcY!=null?h.srcY:0,h.srcWidth,h.srcHeight,h.trgX!=null?h.trgX:0,h.trgY!=null?h.trgY:0,h.trgWidth,h.trgHeight);let g=u.toDataURL("image/png");if(a!=null)return a(g,u)})},a!=null&&(c.onerror=a),c.src=e.dataURL}processQueue(){let{parallelUploads:e}=this.options,t=this.getUploadingFiles().length,i=t;if(t>=e)return;let r=this.getQueuedFiles();if(r.length>0){if(this.options.uploadMultiple)return this.processFiles(r.slice(0,e-t));for(;i<e;){if(!r.length)return;this.processFile(r.shift()),i++}}}processFile(e){return this.processFiles([e])}processFiles(e){for(let t of e)t.processing=!0,t.status=y.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)}_getFilesWithXhr(e){return this.files.filter(t=>t.xhr===e).map(t=>t)}cancelUpload(e){if(e.status===y.UPLOADING){let t=this._getFilesWithXhr(e.xhr);for(let i of t)i.status=y.CANCELED;typeof e.xhr<"u"&&e.xhr.abort();for(let i of t)this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",t)}else(e.status===y.ADDED||e.status===y.QUEUED)&&(e.status=y.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));if(this.options.autoProcessQueue)return this.processQueue()}resolveOption(e,...t){return typeof e=="function"?e.apply(this,t):e}uploadFile(e){return this.uploadFiles([e])}uploadFiles(e){this._transformFiles(e,t=>{if(this.options.chunking){let i=t[0];e[0].upload.chunked=this.options.chunking&&(this.options.forceChunking||i.size>this.options.chunkSize),e[0].upload.totalChunkCount=Math.ceil(i.size/this.options.chunkSize)}if(e[0].upload.chunked){let i=e[0],r=t[0];i.upload.chunks=[];let o=()=>{let a=0;for(;i.upload.chunks[a]!==void 0;)a++;if(a>=i.upload.totalChunkCount)return;let s=a*this.options.chunkSize,c=Math.min(s+this.options.chunkSize,r.size),l={name:this._getParamName(0),data:r.webkitSlice?r.webkitSlice(s,c):r.slice(s,c),filename:i.upload.filename,chunkIndex:a};i.upload.chunks[a]={file:i,index:a,dataBlock:l,status:y.UPLOADING,progress:0,retries:0},this._uploadData(e,[l])};if(i.upload.finishedChunkUpload=(a,s)=>{let c=!0;a.status=y.SUCCESS,a.dataBlock=null,a.response=a.xhr.responseText,a.responseHeaders=a.xhr.getAllResponseHeaders(),a.xhr=null;for(let l=0;l<i.upload.totalChunkCount;l++){if(i.upload.chunks[l]===void 0)return o();i.upload.chunks[l].status!==y.SUCCESS&&(c=!1)}c&&this.options.chunksUploaded(i,()=>{this._finished(e,s,null)})},this.options.parallelChunkUploads)for(let a=0;a<i.upload.totalChunkCount;a++)o();else o()}else{let i=[];for(let r=0;r<e.length;r++)i[r]={name:this._getParamName(r),data:t[r],filename:e[r].upload.filename};this._uploadData(e,i)}})}_getChunk(e,t){for(let i=0;i<e.upload.totalChunkCount;i++)if(e.upload.chunks[i]!==void 0&&e.upload.chunks[i].xhr===t)return e.upload.chunks[i]}_uploadData(e,t){let i=new XMLHttpRequest;for(let l of e)l.xhr=i;e[0].upload.chunked&&(e[0].upload.chunks[t[0].chunkIndex].xhr=i);let r=this.resolveOption(this.options.method,e,t),o=this.resolveOption(this.options.url,e,t);i.open(r,o,!0),this.resolveOption(this.options.timeout,e)&&(i.timeout=this.resolveOption(this.options.timeout,e)),i.withCredentials=!!this.options.withCredentials,i.onload=l=>{this._finishedUploading(e,i,l)},i.ontimeout=()=>{this._handleUploadError(e,i,`Request timedout after ${this.options.timeout/1e3} seconds`)},i.onerror=()=>{this._handleUploadError(e,i)};let s=i.upload!=null?i.upload:i;s.onprogress=l=>this._updateFilesUploadProgress(e,i,l);let c=this.options.defaultHeaders?{Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"}:{};this.options.binaryBody&&(c["Content-Type"]=e[0].type),this.options.headers&&Zi(c,this.options.headers);for(let l in c){let d=c[l];d&&i.setRequestHeader(l,d)}if(this.options.binaryBody){for(let l of e)this.emit("sending",l,i);this.options.uploadMultiple&&this.emit("sendingmultiple",e,i),this.submitRequest(i,null,e)}else{let l=new FormData;if(this.options.params){let d=this.options.params;typeof d=="function"&&(d=d.call(this,e,i,e[0].upload.chunked?this._getChunk(e[0],i):null));for(let h in d){let u=d[h];if(Array.isArray(u))for(let f=0;f<u.length;f++)l.append(h,u[f]);else l.append(h,u)}}for(let d of e)this.emit("sending",d,i,l);this.options.uploadMultiple&&this.emit("sendingmultiple",e,i,l),this._addFormElementData(l);for(let d=0;d<t.length;d++){let h=t[d];l.append(h.name,h.data,h.filename)}this.submitRequest(i,l,e)}}_transformFiles(e,t){let i=[],r=0;for(let o=0;o<e.length;o++)this.options.transformFile.call(this,e[o],a=>{i[o]=a,++r===e.length&&t(i)})}_addFormElementData(e){if(this.element.tagName==="FORM")for(let t of this.element.querySelectorAll("input, textarea, select, button")){let i=t.getAttribute("name"),r=t.getAttribute("type");if(r&&(r=r.toLowerCase()),!(typeof i>"u"||i===null))if(t.tagName==="SELECT"&&t.hasAttribute("multiple"))for(let o of t.options)o.selected&&e.append(i,o.value);else(!r||r!=="checkbox"&&r!=="radio"||t.checked)&&e.append(i,t.value)}}_updateFilesUploadProgress(e,t,i){if(e[0].upload.chunked){let r=e[0],o=this._getChunk(r,t);i?(o.progress=100*i.loaded/i.total,o.total=i.total,o.bytesSent=i.loaded):(o.progress=100,o.bytesSent=o.total),r.upload.progress=0,r.upload.total=0,r.upload.bytesSent=0;for(let a=0;a<r.upload.totalChunkCount;a++)r.upload.chunks[a]&&typeof r.upload.chunks[a].progress<"u"&&(r.upload.progress+=r.upload.chunks[a].progress,r.upload.total+=r.upload.chunks[a].total,r.upload.bytesSent+=r.upload.chunks[a].bytesSent);r.upload.progress=r.upload.progress/r.upload.totalChunkCount,this.emit("uploadprogress",r,r.upload.progress,r.upload.bytesSent)}else for(let r of e)r.upload.total&&r.upload.bytesSent&&r.upload.bytesSent==r.upload.total||(i?(r.upload.progress=100*i.loaded/i.total,r.upload.total=i.total,r.upload.bytesSent=i.loaded):(r.upload.progress=100,r.upload.bytesSent=r.upload.total),this.emit("uploadprogress",r,r.upload.progress,r.upload.bytesSent))}_finishedUploading(e,t,i){let r;if(e[0].status!==y.CANCELED&&t.readyState===4){if(t.responseType!=="arraybuffer"&&t.responseType!=="blob"&&(r=t.responseText,t.getResponseHeader("content-type")&&~t.getResponseHeader("content-type").indexOf("application/json")))try{r=JSON.parse(r)}catch(o){i=o,r="Invalid JSON response from server."}this._updateFilesUploadProgress(e,t),200<=t.status&&t.status<300?e[0].upload.chunked?e[0].upload.finishedChunkUpload(this._getChunk(e[0],t),r):this._finished(e,r,i):this._handleUploadError(e,t,r)}}_handleUploadError(e,t,i){if(e[0].status!==y.CANCELED){if(e[0].upload.chunked&&this.options.retryChunks){let r=this._getChunk(e[0],t);if(r.retries++<this.options.retryChunksLimit){this._uploadData(e,[r.dataBlock]);return}else console.warn("Retried this chunk too often. Giving up.")}this._errorProcessing(e,i||this.options.dictResponseError.replace("{{statusCode}}",t.status),t)}}submitRequest(e,t,i){if(e.readyState!=1){console.warn("Cannot send this request because the XMLHttpRequest.readyState is not OPENED.");return}if(this.options.binaryBody)if(i[0].upload.chunked){const r=this._getChunk(i[0],e);e.send(r.dataBlock.data)}else e.send(i[0]);else e.send(t)}_finished(e,t,i){for(let r of e)r.status=y.SUCCESS,this.emit("success",r,t,i),this.emit("complete",r);if(this.options.uploadMultiple&&(this.emit("successmultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}_errorProcessing(e,t,i){for(let r of e)r.status=y.ERROR,this.emit("error",r,t,i),this.emit("complete",r);if(this.options.uploadMultiple&&(this.emit("errormultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}static uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}constructor(e,t){super();let i,r;if(this.element=e,this.clickableElements=[],this.listeners=[],this.files=[],typeof this.element=="string"&&(this.element=document.querySelector(this.element)),!this.element||this.element.nodeType==null)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");y.instances.push(this),this.element.dropzone=this;let o=(r=y.optionsForElement(this.element))!=null?r:{};if(this.options=Zi(!0,{},Lo,o,t??{}),this.options.previewTemplate=this.options.previewTemplate.replace(/\n*/g,""),this.options.forceFallback||!y.isBrowserSupported())return this.options.fallback.call(this);if(this.options.url==null&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(this.options.uploadMultiple&&this.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");if(this.options.binaryBody&&this.options.uploadMultiple)throw new Error("You cannot set both: binaryBody and uploadMultiple.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.renameFilename!=null&&(this.options.renameFile=a=>this.options.renameFilename.call(this,a.name,a)),typeof this.options.method=="string"&&(this.options.method=this.options.method.toUpperCase()),(i=this.getExistingFallback())&&i.parentNode&&i.parentNode.removeChild(i),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=y.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=y.getElements(this.options.clickable,"clickable")),this.init()}}y.initClass();y.options={};y.optionsForElement=function(n){if(n.getAttribute("id"))return y.options[Fo(n.getAttribute("id"))]};y.instances=[];y.forElement=function(n){if(typeof n=="string"&&(n=document.querySelector(n)),(n!=null?n.dropzone:void 0)==null)throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return n.dropzone};y.discover=function(){let n;if(document.querySelectorAll)n=document.querySelectorAll(".dropzone");else{n=[];let e=t=>(()=>{let i=[];for(let r of t)/(^| )dropzone($| )/.test(r.className)?i.push(n.push(r)):i.push(void 0);return i})();e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))}return(()=>{let e=[];for(let t of n)y.optionsForElement(t)!==!1?e.push(new y(t)):e.push(void 0);return e})()};y.blockedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i];y.isBrowserSupported=function(){let n=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if(!("classList"in document.createElement("a")))n=!1;else{y.blacklistedBrowsers!==void 0&&(y.blockedBrowsers=y.blacklistedBrowsers);for(let e of y.blockedBrowsers)if(e.test(navigator.userAgent)){n=!1;continue}}else n=!1;return n};y.dataURItoBlob=function(n){let e=atob(n.split(",")[1]),t=n.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),r=new Uint8Array(i);for(let o=0,a=e.length,s=0<=a;s?o<=a:o>=a;s?o++:o--)r[o]=e.charCodeAt(o);return new Blob([i],{type:t})};const No=(n,e)=>n.filter(t=>t!==e).map(t=>t),Fo=n=>n.replace(/[\-_](\w)/g,e=>e.charAt(1).toUpperCase());y.createElement=function(n){let e=document.createElement("div");return e.innerHTML=n,e.childNodes[0]};y.elementInside=function(n,e){if(n===e)return!0;for(;n=n.parentNode;)if(n===e)return!0;return!1};y.getElement=function(n,e){let t;if(typeof n=="string"?t=document.querySelector(n):n.nodeType!=null&&(t=n),t==null)throw new Error(`Invalid \`${e}\` option provided. Please provide a CSS selector or a plain HTML element.`);return t};y.getElements=function(n,e){let t,i;if(n instanceof Array){i=[];try{for(t of n)i.push(this.getElement(t,e))}catch{i=null}}else if(typeof n=="string"){i=[];for(t of document.querySelectorAll(n))i.push(t)}else n.nodeType!=null&&(i=[n]);if(i==null||!i.length)throw new Error(`Invalid \`${e}\` option provided. Please provide a CSS selector, a plain HTML element or a list of those.`);return i};y.confirm=function(n,e,t){if(window.confirm(n))return e();if(t!=null)return t()};y.isValidFile=function(n,e){if(!e)return!0;e=e.split(",");let t=n.type,i=t.replace(/\/.*$/,"");for(let r of e)if(r=r.trim(),r.charAt(0)==="."){if(n.name.toLowerCase().indexOf(r.toLowerCase(),n.name.length-r.length)!==-1)return!0}else if(/\/\*$/.test(r)){if(i===r.replace(/\/.*$/,""))return!0}else if(t===r)return!0;return!1};typeof jQuery<"u"&&jQuery!==null&&(jQuery.fn.dropzone=function(n){return this.each(function(){return new y(this,n)})});y.ADDED="added";y.QUEUED="queued";y.ACCEPTED=y.QUEUED;y.UPLOADING="uploading";y.PROCESSING=y.UPLOADING;y.CANCELED="canceled";y.ERROR="error";y.SUCCESS="success";let Io=function(n){n.naturalWidth;let e=n.naturalHeight,t=document.createElement("canvas");t.width=1,t.height=e;let i=t.getContext("2d");i.drawImage(n,0,0);let{data:r}=i.getImageData(1,0,1,e),o=0,a=e,s=e;for(;s>o;)r[(s-1)*4+3]===0?a=s:o=s,s=a+o>>1;let c=s/e;return c===0?1:c};var Ro=function(n,e,t,i,r,o,a,s,c,l){let d=Io(e);return n.drawImage(e,t,i,r,o,a,s,c,l/d)};class jn{static initClass(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}static encode64(e){let t="",i,r,o="",a,s,c,l="",d=0;for(;i=e[d++],r=e[d++],o=e[d++],a=i>>2,s=(i&3)<<4|r>>4,c=(r&15)<<2|o>>6,l=o&63,isNaN(r)?c=l=64:isNaN(o)&&(l=64),t=t+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(c)+this.KEY_STR.charAt(l),i=r=o="",a=s=c=l="",d<e.length;);return t}static restore(e,t){if(!e.match("data:image/jpeg;base64,"))return t;let i=this.decode64(e.replace("data:image/jpeg;base64,","")),r=this.slice2Segments(i),o=this.exifManipulation(t,r);return`data:image/jpeg;base64,${this.encode64(o)}`}static exifManipulation(e,t){let i=this.getExifArray(t),r=this.insertExif(e,i);return new Uint8Array(r)}static getExifArray(e){let t,i=0;for(;i<e.length;){if(t=e[i],t[0]===255&t[1]===225)return t;i++}return[]}static insertExif(e,t){let i=e.replace("data:image/jpeg;base64,",""),r=this.decode64(i),o=r.indexOf(255,3),a=r.slice(0,o),s=r.slice(o),c=a;return c=c.concat(t),c=c.concat(s),c}static slice2Segments(e){let t=0,i=[];for(;;){var r;if(e[t]===255&e[t+1]===218)break;if(e[t]===255&e[t+1]===216)t+=2;else{r=e[t+2]*256+e[t+3];let o=t+r+2,a=e.slice(t,o);i.push(a),t=o}if(t>e.length)break}return i}static decode64(e){let t,i,r="",o,a,s,c="",l=0,d=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&console.warn(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");o=this.KEY_STR.indexOf(e.charAt(l++)),a=this.KEY_STR.indexOf(e.charAt(l++)),s=this.KEY_STR.indexOf(e.charAt(l++)),c=this.KEY_STR.indexOf(e.charAt(l++)),t=o<<2|a>>4,i=(a&15)<<4|s>>2,r=(s&3)<<6|c,d.push(t),s!==64&&d.push(i),c!==64&&d.push(r),t=i=r="",o=a=s=c="",l<e.length;);return d}}jn.initClass();function zo(n,e){return typeof n<"u"&&n!==null?e(n):void 0}function Bo(n,e,t){if(typeof n<"u"&&n!==null&&typeof n[e]=="function")return t(n,e)}/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function tn(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ee(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tn(Object(t),!0).forEach(function(i){Po(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):tn(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function xt(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xt=function(e){return typeof e}:xt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(n)}function Po(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ce(){return Ce=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ce.apply(this,arguments)}function qo(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Ho(n,e){if(n==null)return{};var t=qo(n,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}var Uo="1.15.2";function _e(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Se=_e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ft=_e(/Edge/i),nn=_e(/firefox/i),st=_e(/safari/i)&&!_e(/chrome/i)&&!_e(/android/i),Gn=_e(/iP(ad|od|hone)/i),Kn=_e(/chrome/i)&&_e(/android/i),Qn={capture:!1,passive:!1};function q(n,e,t){n.addEventListener(e,t,!Se&&Qn)}function z(n,e,t){n.removeEventListener(e,t,!Se&&Qn)}function Lt(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function Yo(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function ve(n,e,t,i){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&Lt(n,e):Lt(n,e))||i&&n===t)return n;if(n===t)break}while(n=Yo(n))}return null}var rn=/\s+/g;function le(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var i=(" "+n.className+" ").replace(rn," ").replace(" "+e+" "," ");n.className=(i+(t?" "+e:"")).replace(rn," ")}}function M(n,e,t){var i=n&&n.style;if(i){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=t+(typeof t=="string"?"":"px")}}function Qe(n,e){var t="";if(typeof n=="string")t=n;else do{var i=M(n,"transform");i&&i!=="none"&&(t=i+" "+t)}while(!e&&(n=n.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(t)}function $n(n,e,t){if(n){var i=n.getElementsByTagName(e),r=0,o=i.length;if(t)for(;r<o;r++)t(i[r],r);return i}return[]}function ye(){var n=document.scrollingElement;return n||document.documentElement}function $(n,e,t,i,r){if(!(!n.getBoundingClientRect&&n!==window)){var o,a,s,c,l,d,h;if(n!==window&&n.parentNode&&n!==ye()?(o=n.getBoundingClientRect(),a=o.top,s=o.left,c=o.bottom,l=o.right,d=o.height,h=o.width):(a=0,s=0,c=window.innerHeight,l=window.innerWidth,d=window.innerHeight,h=window.innerWidth),(e||t)&&n!==window&&(r=r||n.parentNode,!Se))do if(r&&r.getBoundingClientRect&&(M(r,"transform")!=="none"||t&&M(r,"position")!=="static")){var u=r.getBoundingClientRect();a-=u.top+parseInt(M(r,"border-top-width")),s-=u.left+parseInt(M(r,"border-left-width")),c=a+o.height,l=s+o.width;break}while(r=r.parentNode);if(i&&n!==window){var f=Qe(r||n),g=f&&f.a,b=f&&f.d;f&&(a/=b,s/=g,h/=g,d/=b,c=a+d,l=s+h)}return{top:a,left:s,bottom:c,right:l,width:h,height:d}}}function on(n,e,t){for(var i=Oe(n,!0),r=$(n)[e];i;){var o=$(i)[t],a=void 0;if(t==="top"||t==="left"?a=r>=o:a=r<=o,!a)return i;if(i===ye())break;i=Oe(i,!1)}return!1}function $e(n,e,t,i){for(var r=0,o=0,a=n.children;o<a.length;){if(a[o].style.display!=="none"&&a[o]!==O.ghost&&(i||a[o]!==O.dragged)&&ve(a[o],t.draggable,n,!1)){if(r===e)return a[o];r++}o++}return null}function Ti(n,e){for(var t=n.lastElementChild;t&&(t===O.ghost||M(t,"display")==="none"||e&&!Lt(t,e));)t=t.previousElementSibling;return t||null}function pe(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==O.clone&&(!e||Lt(n,e))&&t++;return t}function an(n){var e=0,t=0,i=ye();if(n)do{var r=Qe(n),o=r.a,a=r.d;e+=n.scrollLeft*o,t+=n.scrollTop*a}while(n!==i&&(n=n.parentNode));return[e,t]}function Wo(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===n[t][i])return Number(t)}return-1}function Oe(n,e){if(!n||!n.getBoundingClientRect)return ye();var t=n,i=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var r=M(t);if(t.clientWidth<t.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return ye();if(i||e)return t;i=!0}}while(t=t.parentNode);return ye()}function Xo(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Ut(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var lt;function Zn(n,e){return function(){if(!lt){var t=arguments,i=this;t.length===1?n.call(i,t[0]):n.apply(i,t),lt=setTimeout(function(){lt=void 0},e)}}}function Vo(){clearTimeout(lt),lt=void 0}function Jn(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function er(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function tr(n,e,t){var i={};return Array.from(n.children).forEach(function(r){var o,a,s,c;if(!(!ve(r,e.draggable,n,!1)||r.animated||r===t)){var l=$(r);i.left=Math.min((o=i.left)!==null&&o!==void 0?o:1/0,l.left),i.top=Math.min((a=i.top)!==null&&a!==void 0?a:1/0,l.top),i.right=Math.max((s=i.right)!==null&&s!==void 0?s:-1/0,l.right),i.bottom=Math.max((c=i.bottom)!==null&&c!==void 0?c:-1/0,l.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var de="Sortable"+new Date().getTime();function jo(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(r){if(!(M(r,"display")==="none"||r===O.ghost)){n.push({target:r,rect:$(r)});var o=Ee({},n[n.length-1].rect);if(r.thisAnimationDuration){var a=Qe(r,!0);a&&(o.top-=a.f,o.left-=a.e)}r.fromRect=o}})}},addAnimationState:function(i){n.push(i)},removeAnimationState:function(i){n.splice(Wo(n,{target:i}),1)},animateAll:function(i){var r=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var o=!1,a=0;n.forEach(function(s){var c=0,l=s.target,d=l.fromRect,h=$(l),u=l.prevFromRect,f=l.prevToRect,g=s.rect,b=Qe(l,!0);b&&(h.top-=b.f,h.left-=b.e),l.toRect=h,l.thisAnimationDuration&&Ut(u,h)&&!Ut(d,h)&&(g.top-h.top)/(g.left-h.left)===(d.top-h.top)/(d.left-h.left)&&(c=Ko(g,u,f,r.options)),Ut(h,d)||(l.prevFromRect=d,l.prevToRect=h,c||(c=r.options.animation),r.animate(l,g,h,c)),c&&(o=!0,a=Math.max(a,c),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0,l.prevFromRect=null,l.fromRect=null,l.prevToRect=null,l.thisAnimationDuration=null},c),l.thisAnimationDuration=c)}),clearTimeout(e),o?e=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),n=[]},animate:function(i,r,o,a){if(a){M(i,"transition",""),M(i,"transform","");var s=Qe(this.el),c=s&&s.a,l=s&&s.d,d=(r.left-o.left)/(c||1),h=(r.top-o.top)/(l||1);i.animatingX=!!d,i.animatingY=!!h,M(i,"transform","translate3d("+d+"px,"+h+"px,0)"),this.forRepaintDummy=Go(i),M(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),M(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){M(i,"transition",""),M(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function Go(n){return n.offsetWidth}function Ko(n,e,t,i){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*i.animation}var He=[],Yt={initializeByDefault:!0},mt={mount:function(e){for(var t in Yt)Yt.hasOwnProperty(t)&&!(t in e)&&(e[t]=Yt[t]);He.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),He.push(e)},pluginEvent:function(e,t,i){var r=this;this.eventCanceled=!1,i.cancel=function(){r.eventCanceled=!0};var o=e+"Global";He.forEach(function(a){t[a.pluginName]&&(t[a.pluginName][o]&&t[a.pluginName][o](Ee({sortable:t},i)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](Ee({sortable:t},i)))})},initializePlugins:function(e,t,i,r){He.forEach(function(s){var c=s.pluginName;if(!(!e.options[c]&&!s.initializeByDefault)){var l=new s(e,t,e.options);l.sortable=e,l.options=e.options,e[c]=l,Ce(i,l.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);typeof a<"u"&&(e.options[o]=a)}},getEventProperties:function(e,t){var i={};return He.forEach(function(r){typeof r.eventProperties=="function"&&Ce(i,r.eventProperties.call(t[r.pluginName],e))}),i},modifyOption:function(e,t,i){var r;return He.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[t]=="function"&&(r=o.optionListeners[t].call(e[o.pluginName],i))}),r}};function Qo(n){var e=n.sortable,t=n.rootEl,i=n.name,r=n.targetEl,o=n.cloneEl,a=n.toEl,s=n.fromEl,c=n.oldIndex,l=n.newIndex,d=n.oldDraggableIndex,h=n.newDraggableIndex,u=n.originalEvent,f=n.putSortable,g=n.extraEventProperties;if(e=e||t&&t[de],!!e){var b,E=e.options,S="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!Se&&!ft?b=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(b=document.createEvent("Event"),b.initEvent(i,!0,!0)),b.to=a||t,b.from=s||t,b.item=r||t,b.clone=o,b.oldIndex=c,b.newIndex=l,b.oldDraggableIndex=d,b.newDraggableIndex=h,b.originalEvent=u,b.pullMode=f?f.lastPutMode:void 0;var T=Ee(Ee({},g),mt.getEventProperties(i,e));for(var A in T)b[A]=T[A];t&&t.dispatchEvent(b),E[S]&&E[S].call(e,b)}}var $o=["evt"],oe=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.evt,o=Ho(i,$o);mt.pluginEvent.bind(O)(e,t,Ee({dragEl:w,parentEl:j,ghostEl:L,rootEl:U,nextEl:Be,lastDownEl:Tt,cloneEl:V,cloneHidden:Te,dragStarted:nt,putSortable:ee,activeSortable:O.active,originalEvent:r,oldIndex:Ve,oldDraggableIndex:ct,newIndex:ce,newDraggableIndex:xe,hideGhostForTarget:or,unhideGhostForTarget:ar,cloneNowHidden:function(){Te=!0},cloneNowShown:function(){Te=!1},dispatchSortableEvent:function(s){ne({sortable:t,name:s,originalEvent:r})}},o))};function ne(n){Qo(Ee({putSortable:ee,cloneEl:V,targetEl:w,rootEl:U,oldIndex:Ve,oldDraggableIndex:ct,newIndex:ce,newDraggableIndex:xe},n))}var w,j,L,U,Be,Tt,V,Te,Ve,ce,ct,xe,yt,ee,Ye=!1,Nt=!1,Ft=[],Re,ge,Wt,Xt,sn,ln,nt,Ue,dt,ht=!1,wt=!1,At,ie,Vt=[],vi=!1,It=[],Bt=typeof document<"u",Et=Gn,cn=ft||Se?"cssFloat":"float",Zo=Bt&&!Kn&&!Gn&&"draggable"in document.createElement("div"),ir=function(){if(Bt){if(Se)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),nr=function(e,t){var i=M(e),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),o=$e(e,0,t),a=$e(e,1,t),s=o&&M(o),c=a&&M(a),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+$(o).width,d=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+$(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&s.float&&s.float!=="none"){var h=s.float==="left"?"left":"right";return a&&(c.clear==="both"||c.clear===h)?"vertical":"horizontal"}return o&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||l>=r&&i[cn]==="none"||a&&i[cn]==="none"&&l+d>r)?"vertical":"horizontal"},Jo=function(e,t,i){var r=i?e.left:e.top,o=i?e.right:e.bottom,a=i?e.width:e.height,s=i?t.left:t.top,c=i?t.right:t.bottom,l=i?t.width:t.height;return r===s||o===c||r+a/2===s+l/2},ea=function(e,t){var i;return Ft.some(function(r){var o=r[de].options.emptyInsertThreshold;if(!(!o||Ti(r))){var a=$(r),s=e>=a.left-o&&e<=a.right+o,c=t>=a.top-o&&t<=a.bottom+o;if(s&&c)return i=r}}),i},rr=function(e){function t(o,a){return function(s,c,l,d){var h=s.options.group.name&&c.options.group.name&&s.options.group.name===c.options.group.name;if(o==null&&(a||h))return!0;if(o==null||o===!1)return!1;if(a&&o==="clone")return o;if(typeof o=="function")return t(o(s,c,l,d),a)(s,c,l,d);var u=(a?s:c).options.group.name;return o===!0||typeof o=="string"&&o===u||o.join&&o.indexOf(u)>-1}}var i={},r=e.group;(!r||xt(r)!="object")&&(r={name:r}),i.name=r.name,i.checkPull=t(r.pull,!0),i.checkPut=t(r.put),i.revertClone=r.revertClone,e.group=i},or=function(){!ir&&L&&M(L,"display","none")},ar=function(){!ir&&L&&M(L,"display","")};Bt&&!Kn&&document.addEventListener("click",function(n){if(Nt)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),Nt=!1,!1},!0);var ze=function(e){if(w){e=e.touches?e.touches[0]:e;var t=ea(e.clientX,e.clientY);if(t){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[de]._onDragOver(i)}}},ta=function(e){w&&w.parentNode[de]._isOutsideThisEl(e.target)};function O(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=Ce({},e),n[de]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return nr(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:O.supportPointer!==!1&&"PointerEvent"in window&&!st,emptyInsertThreshold:5};mt.initializePlugins(this,n,t);for(var i in t)!(i in e)&&(e[i]=t[i]);rr(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:Zo,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?q(n,"pointerdown",this._onTapStart):(q(n,"mousedown",this._onTapStart),q(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(q(n,"dragover",this),q(n,"dragenter",this)),Ft.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Ce(this,jo())}O.prototype={constructor:O,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ue=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,w):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,r=this.options,o=r.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,c=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||c,d=r.filter;if(ca(i),!w&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||r.disabled)&&!l.isContentEditable&&!(!this.nativeDraggable&&st&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=ve(c,r.draggable,i,!1),!(c&&c.animated)&&Tt!==c)){if(Ve=pe(c),ct=pe(c,r.draggable),typeof d=="function"){if(d.call(this,e,c,this)){ne({sortable:t,rootEl:l,name:"filter",targetEl:c,toEl:i,fromEl:i}),oe("filter",t,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(h){if(h=ve(l,h.trim(),i,!1),h)return ne({sortable:t,rootEl:h,name:"filter",targetEl:c,fromEl:i,toEl:i}),oe("filter",t,{evt:e}),!0}),d)){o&&e.cancelable&&e.preventDefault();return}r.handle&&!ve(l,r.handle,i,!1)||this._prepareDragStart(e,s,c)}}},_prepareDragStart:function(e,t,i){var r=this,o=r.el,a=r.options,s=o.ownerDocument,c;if(i&&!w&&i.parentNode===o){var l=$(i);if(U=o,w=i,j=w.parentNode,Be=w.nextSibling,Tt=i,yt=a.group,O.dragged=w,Re={target:w,clientX:(t||e).clientX,clientY:(t||e).clientY},sn=Re.clientX-l.left,ln=Re.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,w.style["will-change"]="all",c=function(){if(oe("delayEnded",r,{evt:e}),O.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!nn&&r.nativeDraggable&&(w.draggable=!0),r._triggerDragStart(e,t),ne({sortable:r,name:"choose",originalEvent:e}),le(w,a.chosenClass,!0)},a.ignore.split(",").forEach(function(d){$n(w,d.trim(),jt)}),q(s,"dragover",ze),q(s,"mousemove",ze),q(s,"touchmove",ze),q(s,"mouseup",r._onDrop),q(s,"touchend",r._onDrop),q(s,"touchcancel",r._onDrop),nn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,w.draggable=!0),oe("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(ft||Se))){if(O.eventCanceled){this._onDrop();return}q(s,"mouseup",r._disableDelayedDrag),q(s,"touchend",r._disableDelayedDrag),q(s,"touchcancel",r._disableDelayedDrag),q(s,"mousemove",r._delayedDragTouchMoveHandler),q(s,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&q(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(c,a.delay)}else c()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){w&&jt(w),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;z(e,"mouseup",this._disableDelayedDrag),z(e,"touchend",this._disableDelayedDrag),z(e,"touchcancel",this._disableDelayedDrag),z(e,"mousemove",this._delayedDragTouchMoveHandler),z(e,"touchmove",this._delayedDragTouchMoveHandler),z(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?q(document,"pointermove",this._onTouchMove):t?q(document,"touchmove",this._onTouchMove):q(document,"mousemove",this._onTouchMove):(q(w,"dragend",this),q(U,"dragstart",this._onDragStart));try{document.selection?Mt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Ye=!1,U&&w){oe("dragStarted",this,{evt:t}),this.nativeDraggable&&q(document,"dragover",ta);var i=this.options;!e&&le(w,i.dragClass,!1),le(w,i.ghostClass,!0),O.active=this,e&&this._appendGhost(),ne({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ge){this._lastX=ge.clientX,this._lastY=ge.clientY,or();for(var e=document.elementFromPoint(ge.clientX,ge.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ge.clientX,ge.clientY),e!==t);)t=e;if(w.parentNode[de]._isOutsideThisEl(e),t)do{if(t[de]){var i=void 0;if(i=t[de]._onDragOver({clientX:ge.clientX,clientY:ge.clientY,target:e,rootEl:t}),i&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);ar()}},_onTouchMove:function(e){if(Re){var t=this.options,i=t.fallbackTolerance,r=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=L&&Qe(L,!0),s=L&&a&&a.a,c=L&&a&&a.d,l=Et&&ie&&an(ie),d=(o.clientX-Re.clientX+r.x)/(s||1)+(l?l[0]-Vt[0]:0)/(s||1),h=(o.clientY-Re.clientY+r.y)/(c||1)+(l?l[1]-Vt[1]:0)/(c||1);if(!O.active&&!Ye){if(i&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(L){a?(a.e+=d-(Wt||0),a.f+=h-(Xt||0)):a={a:1,b:0,c:0,d:1,e:d,f:h};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");M(L,"webkitTransform",u),M(L,"mozTransform",u),M(L,"msTransform",u),M(L,"transform",u),Wt=d,Xt=h,ge=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!L){var e=this.options.fallbackOnBody?document.body:U,t=$(w,!0,Et,!0,e),i=this.options;if(Et){for(ie=e;M(ie,"position")==="static"&&M(ie,"transform")==="none"&&ie!==document;)ie=ie.parentNode;ie!==document.body&&ie!==document.documentElement?(ie===document&&(ie=ye()),t.top+=ie.scrollTop,t.left+=ie.scrollLeft):ie=ye(),Vt=an(ie)}L=w.cloneNode(!0),le(L,i.ghostClass,!1),le(L,i.fallbackClass,!0),le(L,i.dragClass,!0),M(L,"transition",""),M(L,"transform",""),M(L,"box-sizing","border-box"),M(L,"margin",0),M(L,"top",t.top),M(L,"left",t.left),M(L,"width",t.width),M(L,"height",t.height),M(L,"opacity","0.8"),M(L,"position",Et?"absolute":"fixed"),M(L,"zIndex","100000"),M(L,"pointerEvents","none"),O.ghost=L,e.appendChild(L),M(L,"transform-origin",sn/parseInt(L.style.width)*100+"% "+ln/parseInt(L.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,r=e.dataTransfer,o=i.options;if(oe("dragStart",this,{evt:e}),O.eventCanceled){this._onDrop();return}oe("setupClone",this),O.eventCanceled||(V=er(w),V.removeAttribute("id"),V.draggable=!1,V.style["will-change"]="",this._hideClone(),le(V,this.options.chosenClass,!1),O.clone=V),i.cloneId=Mt(function(){oe("clone",i),!O.eventCanceled&&(i.options.removeCloneOnHide||U.insertBefore(V,w),i._hideClone(),ne({sortable:i,name:"clone"}))}),!t&&le(w,o.dragClass,!0),t?(Nt=!0,i._loopId=setInterval(i._emulateDragOver,50)):(z(document,"mouseup",i._onDrop),z(document,"touchend",i._onDrop),z(document,"touchcancel",i._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(i,r,w)),q(document,"drop",i),M(w,"transform","translateZ(0)")),Ye=!0,i._dragStartId=Mt(i._dragStarted.bind(i,t,e)),q(document,"selectstart",i),nt=!0,st&&M(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,i=e.target,r,o,a,s=this.options,c=s.group,l=O.active,d=yt===c,h=s.sort,u=ee||l,f,g=this,b=!1;if(vi)return;function E(G,te){oe(G,g,Ee({evt:e,isOwner:d,axis:f?"vertical":"horizontal",revert:a,dragRect:r,targetRect:o,canSort:h,fromSortable:u,target:i,completed:T,onMove:function(I,X){return _t(U,t,w,r,I,$(I),e,X)},changed:A},te))}function S(){E("dragOverAnimationCapture"),g.captureAnimationState(),g!==u&&u.captureAnimationState()}function T(G){return E("dragOverCompleted",{insertion:G}),G&&(d?l._hideClone():l._showClone(g),g!==u&&(le(w,ee?ee.options.ghostClass:l.options.ghostClass,!1),le(w,s.ghostClass,!0)),ee!==g&&g!==O.active?ee=g:g===O.active&&ee&&(ee=null),u===g&&(g._ignoreWhileAnimating=i),g.animateAll(function(){E("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(i===w&&!w.animated||i===t&&!i.animated)&&(Ue=null),!s.dragoverBubble&&!e.rootEl&&i!==document&&(w.parentNode[de]._isOutsideThisEl(e.target),!G&&ze(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),b=!0}function A(){ce=pe(w),xe=pe(w,s.draggable),ne({sortable:g,name:"change",toEl:t,newIndex:ce,newDraggableIndex:xe,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=ve(i,s.draggable,t,!0),E("dragOver"),O.eventCanceled)return b;if(w.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||g._ignoreWhileAnimating===i)return T(!1);if(Nt=!1,l&&!s.disabled&&(d?h||(a=j!==U):ee===this||(this.lastPutMode=yt.checkPull(this,l,w,e))&&c.checkPut(this,l,w,e))){if(f=this._getDirection(e,i)==="vertical",r=$(w),E("dragOverValid"),O.eventCanceled)return b;if(a)return j=U,S(),this._hideClone(),E("revert"),O.eventCanceled||(Be?U.insertBefore(w,Be):U.appendChild(w)),T(!0);var B=Ti(t,s.draggable);if(!B||oa(e,f,this)&&!B.animated){if(B===w)return T(!1);if(B&&t===e.target&&(i=B),i&&(o=$(i)),_t(U,t,w,r,i,o,e,!!i)!==!1)return S(),B&&B.nextSibling?t.insertBefore(w,B.nextSibling):t.appendChild(w),j=t,A(),T(!0)}else if(B&&ra(e,f,this)){var H=$e(t,0,s,!0);if(H===w)return T(!1);if(i=H,o=$(i),_t(U,t,w,r,i,o,e,!1)!==!1)return S(),t.insertBefore(w,H),j=t,A(),T(!0)}else if(i.parentNode===t){o=$(i);var p=0,v,D=w.parentNode!==t,x=!Jo(w.animated&&w.toRect||r,i.animated&&i.toRect||o,f),m=f?"top":"left",C=on(i,"top","top")||on(w,"top","top"),_=C?C.scrollTop:void 0;Ue!==i&&(v=o[m],ht=!1,wt=!x&&s.invertSwap||D),p=aa(e,i,o,f,x?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,wt,Ue===i);var k;if(p!==0){var N=pe(w);do N-=p,k=j.children[N];while(k&&(M(k,"display")==="none"||k===L))}if(p===0||k===i)return T(!1);Ue=i,dt=p;var F=i.nextElementSibling,P=!1;P=p===1;var K=_t(U,t,w,r,i,o,e,P);if(K!==!1)return(K===1||K===-1)&&(P=K===1),vi=!0,setTimeout(na,30),S(),P&&!F?t.appendChild(w):i.parentNode.insertBefore(w,P?F:i),C&&Jn(C,0,_-C.scrollTop),j=w.parentNode,v!==void 0&&!wt&&(At=Math.abs(v-$(i)[m])),A(),T(!0)}if(t.contains(w))return T(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){z(document,"mousemove",this._onTouchMove),z(document,"touchmove",this._onTouchMove),z(document,"pointermove",this._onTouchMove),z(document,"dragover",ze),z(document,"mousemove",ze),z(document,"touchmove",ze)},_offUpEvents:function(){var e=this.el.ownerDocument;z(e,"mouseup",this._onDrop),z(e,"touchend",this._onDrop),z(e,"pointerup",this._onDrop),z(e,"touchcancel",this._onDrop),z(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;if(ce=pe(w),xe=pe(w,i.draggable),oe("drop",this,{evt:e}),j=w&&w.parentNode,ce=pe(w),xe=pe(w,i.draggable),O.eventCanceled){this._nulling();return}Ye=!1,wt=!1,ht=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),bi(this.cloneId),bi(this._dragStartId),this.nativeDraggable&&(z(document,"drop",this),z(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),st&&M(document.body,"user-select",""),M(w,"transform",""),e&&(nt&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),L&&L.parentNode&&L.parentNode.removeChild(L),(U===j||ee&&ee.lastPutMode!=="clone")&&V&&V.parentNode&&V.parentNode.removeChild(V),w&&(this.nativeDraggable&&z(w,"dragend",this),jt(w),w.style["will-change"]="",nt&&!Ye&&le(w,ee?ee.options.ghostClass:this.options.ghostClass,!1),le(w,this.options.chosenClass,!1),ne({sortable:this,name:"unchoose",toEl:j,newIndex:null,newDraggableIndex:null,originalEvent:e}),U!==j?(ce>=0&&(ne({rootEl:j,name:"add",toEl:j,fromEl:U,originalEvent:e}),ne({sortable:this,name:"remove",toEl:j,originalEvent:e}),ne({rootEl:j,name:"sort",toEl:j,fromEl:U,originalEvent:e}),ne({sortable:this,name:"sort",toEl:j,originalEvent:e})),ee&&ee.save()):ce!==Ve&&ce>=0&&(ne({sortable:this,name:"update",toEl:j,originalEvent:e}),ne({sortable:this,name:"sort",toEl:j,originalEvent:e})),O.active&&((ce==null||ce===-1)&&(ce=Ve,xe=ct),ne({sortable:this,name:"end",toEl:j,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){oe("nulling",this),U=w=j=L=Be=V=Tt=Te=Re=ge=nt=ce=xe=Ve=ct=Ue=dt=ee=yt=O.dragged=O.ghost=O.clone=O.active=null,It.forEach(function(e){e.checked=!0}),It.length=Wt=Xt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":w&&(this._onDragOver(e),ia(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,i=this.el.children,r=0,o=i.length,a=this.options;r<o;r++)t=i[r],ve(t,a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||la(t));return e},sort:function(e,t){var i={},r=this.el;this.toArray().forEach(function(o,a){var s=r.children[a];ve(s,this.options.draggable,r,!1)&&(i[o]=s)},this),t&&this.captureAnimationState(),e.forEach(function(o){i[o]&&(r.removeChild(i[o]),r.appendChild(i[o]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ve(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(t===void 0)return i[e];var r=mt.modifyOption(this,e,t);typeof r<"u"?i[e]=r:i[e]=t,e==="group"&&rr(i)},destroy:function(){oe("destroy",this);var e=this.el;e[de]=null,z(e,"mousedown",this._onTapStart),z(e,"touchstart",this._onTapStart),z(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(z(e,"dragover",this),z(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ft.splice(Ft.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Te){if(oe("hideClone",this),O.eventCanceled)return;M(V,"display","none"),this.options.removeCloneOnHide&&V.parentNode&&V.parentNode.removeChild(V),Te=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Te){if(oe("showClone",this),O.eventCanceled)return;w.parentNode==U&&!this.options.group.revertClone?U.insertBefore(V,w):Be?U.insertBefore(V,Be):U.appendChild(V),this.options.group.revertClone&&this.animate(w,V),M(V,"display",""),Te=!1}}};function ia(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function _t(n,e,t,i,r,o,a,s){var c,l=n[de],d=l.options.onMove,h;return window.CustomEvent&&!Se&&!ft?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=e,c.from=n,c.dragged=t,c.draggedRect=i,c.related=r||e,c.relatedRect=o||$(e),c.willInsertAfter=s,c.originalEvent=a,n.dispatchEvent(c),d&&(h=d.call(l,c,a)),h}function jt(n){n.draggable=!1}function na(){vi=!1}function ra(n,e,t){var i=$($e(t.el,0,t.options,!0)),r=tr(t.el,t.options,L),o=10;return e?n.clientX<r.left-o||n.clientY<i.top&&n.clientX<i.right:n.clientY<r.top-o||n.clientY<i.bottom&&n.clientX<i.left}function oa(n,e,t){var i=$(Ti(t.el,t.options.draggable)),r=tr(t.el,t.options,L),o=10;return e?n.clientX>r.right+o||n.clientY>i.bottom&&n.clientX>i.left:n.clientY>r.bottom+o||n.clientX>i.right&&n.clientY>i.top}function aa(n,e,t,i,r,o,a,s){var c=i?n.clientY:n.clientX,l=i?t.height:t.width,d=i?t.top:t.left,h=i?t.bottom:t.right,u=!1;if(!a){if(s&&At<l*r){if(!ht&&(dt===1?c>d+l*o/2:c<h-l*o/2)&&(ht=!0),ht)u=!0;else if(dt===1?c<d+At:c>h-At)return-dt}else if(c>d+l*(1-r)/2&&c<h-l*(1-r)/2)return sa(e)}return u=u||a,u&&(c<d+l*o/2||c>h-l*o/2)?c>d+l/2?1:-1:0}function sa(n){return pe(w)<pe(n)?1:-1}function la(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,i=0;t--;)i+=e.charCodeAt(t);return i.toString(36)}function ca(n){It.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var i=e[t];i.checked&&It.push(i)}}function Mt(n){return setTimeout(n,0)}function bi(n){return clearTimeout(n)}Bt&&q(document,"touchmove",function(n){(O.active||Ye)&&n.cancelable&&n.preventDefault()});O.utils={on:q,off:z,css:M,find:$n,is:function(e,t){return!!ve(e,t,e,!1)},extend:Xo,throttle:Zn,closest:ve,toggleClass:le,clone:er,index:pe,nextTick:Mt,cancelNextTick:bi,detectDirection:nr,getChild:$e};O.get=function(n){return n[de]};O.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(O.utils=Ee(Ee({},O.utils),i.utils)),mt.mount(i)})};O.create=function(n,e){return new O(n,e)};O.version=Uo;var Q=[],rt,yi,wi=!1,Gt,Kt,Rt,ot;function da(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var i=t.originalEvent;this.sortable.nativeDraggable?q(document,"dragover",this._handleAutoScroll):this.options.supportPointer?q(document,"pointermove",this._handleFallbackAutoScroll):i.touches?q(document,"touchmove",this._handleFallbackAutoScroll):q(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var i=t.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?z(document,"dragover",this._handleAutoScroll):(z(document,"pointermove",this._handleFallbackAutoScroll),z(document,"touchmove",this._handleFallbackAutoScroll),z(document,"mousemove",this._handleFallbackAutoScroll)),dn(),Ot(),Vo()},nulling:function(){Rt=yi=rt=wi=ot=Gt=Kt=null,Q.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,i){var r=this,o=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,s=document.elementFromPoint(o,a);if(Rt=t,i||this.options.forceAutoScrollFallback||ft||Se||st){Qt(t,this.options,s,i);var c=Oe(s,!0);wi&&(!ot||o!==Gt||a!==Kt)&&(ot&&dn(),ot=setInterval(function(){var l=Oe(document.elementFromPoint(o,a),!0);l!==c&&(c=l,Ot()),Qt(t,r.options,l,i)},10),Gt=o,Kt=a)}else{if(!this.options.bubbleScroll||Oe(s,!0)===ye()){Ot();return}Qt(t,this.options,Oe(s,!1),!1)}}},Ce(n,{pluginName:"scroll",initializeByDefault:!0})}function Ot(){Q.forEach(function(n){clearInterval(n.pid)}),Q=[]}function dn(){clearInterval(ot)}var Qt=Zn(function(n,e,t,i){if(e.scroll){var r=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,a=e.scrollSensitivity,s=e.scrollSpeed,c=ye(),l=!1,d;yi!==t&&(yi=t,Ot(),rt=e.scroll,d=e.scrollFn,rt===!0&&(rt=Oe(t,!0)));var h=0,u=rt;do{var f=u,g=$(f),b=g.top,E=g.bottom,S=g.left,T=g.right,A=g.width,B=g.height,H=void 0,p=void 0,v=f.scrollWidth,D=f.scrollHeight,x=M(f),m=f.scrollLeft,C=f.scrollTop;f===c?(H=A<v&&(x.overflowX==="auto"||x.overflowX==="scroll"||x.overflowX==="visible"),p=B<D&&(x.overflowY==="auto"||x.overflowY==="scroll"||x.overflowY==="visible")):(H=A<v&&(x.overflowX==="auto"||x.overflowX==="scroll"),p=B<D&&(x.overflowY==="auto"||x.overflowY==="scroll"));var _=H&&(Math.abs(T-r)<=a&&m+A<v)-(Math.abs(S-r)<=a&&!!m),k=p&&(Math.abs(E-o)<=a&&C+B<D)-(Math.abs(b-o)<=a&&!!C);if(!Q[h])for(var N=0;N<=h;N++)Q[N]||(Q[N]={});(Q[h].vx!=_||Q[h].vy!=k||Q[h].el!==f)&&(Q[h].el=f,Q[h].vx=_,Q[h].vy=k,clearInterval(Q[h].pid),(_!=0||k!=0)&&(l=!0,Q[h].pid=setInterval((function(){i&&this.layer===0&&O.active._onTouchMove(Rt);var F=Q[this.layer].vy?Q[this.layer].vy*s:0,P=Q[this.layer].vx?Q[this.layer].vx*s:0;typeof d=="function"&&d.call(O.dragged.parentNode[de],P,F,n,Rt,Q[this.layer].el)!=="continue"||Jn(Q[this.layer].el,P,F)}).bind({layer:h}),24))),h++}while(e.bubbleScroll&&u!==c&&(u=Oe(u,!1)));wi=l}},30),sr=function(e){var t=e.originalEvent,i=e.putSortable,r=e.dragEl,o=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,c=e.unhideGhostForTarget;if(t){var l=i||o;s();var d=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,h=document.elementFromPoint(d.clientX,d.clientY);c(),l&&!l.el.contains(h)&&(a("spill"),this.onSpill({dragEl:r,putSortable:i}))}};function Ai(){}Ai.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var r=$e(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:sr};Ce(Ai,{pluginName:"revertOnSpill"});function Mi(){}Mi.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable,r=i||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:sr};Ce(Mi,{pluginName:"removeOnSpill"});O.mount(new da);O.mount(Mi,Ai);var lr={exports:{}},$t={exports:{}},Zt={exports:{}};/*!
  * Bootstrap data.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var hn;function ha(){return hn||(hn=1,function(n,e){(function(t,i){n.exports=i()})(he,function(){const t=new Map;return{set(r,o,a){t.has(r)||t.set(r,new Map);const s=t.get(r);if(!s.has(o)&&s.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(s.keys())[0]}.`);return}s.set(o,a)},get(r,o){return t.has(r)&&t.get(r).get(o)||null},remove(r,o){if(!t.has(r))return;const a=t.get(r);a.delete(o),a.size===0&&t.delete(r)}}})}(Zt)),Zt.exports}var Jt={exports:{}},Ct={exports:{}};/*!
  * Bootstrap index.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var un;function ke(){return un||(un=1,function(n,e){(function(t,i){i(e)})(he,function(t){const o="transitionend",a=m=>(m&&window.CSS&&window.CSS.escape&&(m=m.replace(/#([^\s"#']+)/g,(C,_)=>`#${CSS.escape(_)}`)),m),s=m=>m==null?`${m}`:Object.prototype.toString.call(m).match(/\s([a-z]+)/i)[1].toLowerCase(),c=m=>{do m+=Math.floor(Math.random()*1e6);while(document.getElementById(m));return m},l=m=>{if(!m)return 0;let{transitionDuration:C,transitionDelay:_}=window.getComputedStyle(m);const k=Number.parseFloat(C),N=Number.parseFloat(_);return!k&&!N?0:(C=C.split(",")[0],_=_.split(",")[0],(Number.parseFloat(C)+Number.parseFloat(_))*1e3)},d=m=>{m.dispatchEvent(new Event(o))},h=m=>!m||typeof m!="object"?!1:(typeof m.jquery<"u"&&(m=m[0]),typeof m.nodeType<"u"),u=m=>h(m)?m.jquery?m[0]:m:typeof m=="string"&&m.length>0?document.querySelector(a(m)):null,f=m=>{if(!h(m)||m.getClientRects().length===0)return!1;const C=getComputedStyle(m).getPropertyValue("visibility")==="visible",_=m.closest("details:not([open])");if(!_)return C;if(_!==m){const k=m.closest("summary");if(k&&k.parentNode!==_||k===null)return!1}return C},g=m=>!m||m.nodeType!==Node.ELEMENT_NODE||m.classList.contains("disabled")?!0:typeof m.disabled<"u"?m.disabled:m.hasAttribute("disabled")&&m.getAttribute("disabled")!=="false",b=m=>{if(!document.documentElement.attachShadow)return null;if(typeof m.getRootNode=="function"){const C=m.getRootNode();return C instanceof ShadowRoot?C:null}return m instanceof ShadowRoot?m:m.parentNode?b(m.parentNode):null},E=()=>{},S=m=>{m.offsetHeight},T=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,A=[],B=m=>{document.readyState==="loading"?(A.length||document.addEventListener("DOMContentLoaded",()=>{for(const C of A)C()}),A.push(m)):m()},H=()=>document.documentElement.dir==="rtl",p=m=>{B(()=>{const C=T();if(C){const _=m.NAME,k=C.fn[_];C.fn[_]=m.jQueryInterface,C.fn[_].Constructor=m,C.fn[_].noConflict=()=>(C.fn[_]=k,m.jQueryInterface)}})},v=(m,C=[],_=m)=>typeof m=="function"?m(...C):_,D=(m,C,_=!0)=>{if(!_){v(m);return}const k=5,N=l(C)+k;let F=!1;const P=({target:K})=>{K===C&&(F=!0,C.removeEventListener(o,P),v(m))};C.addEventListener(o,P),setTimeout(()=>{F||d(C)},N)},x=(m,C,_,k)=>{const N=m.length;let F=m.indexOf(C);return F===-1?!_&&k?m[N-1]:m[0]:(F+=_?1:-1,k&&(F=(F+N)%N),m[Math.max(0,Math.min(F,N-1))])};t.defineJQueryPlugin=p,t.execute=v,t.executeAfterTransition=D,t.findShadowRoot=b,t.getElement=u,t.getNextActiveElement=x,t.getTransitionDurationFromElement=l,t.getUID=c,t.getjQuery=T,t.isDisabled=g,t.isElement=h,t.isRTL=H,t.isVisible=f,t.noop=E,t.onDOMContentLoaded=B,t.parseSelector=a,t.reflow=S,t.toType=s,t.triggerTransitionEnd=d,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})}(Ct,Ct.exports)),Ct.exports}/*!
  * Bootstrap event-handler.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var pn;function gt(){return pn||(pn=1,function(n,e){(function(t,i){n.exports=i(ke())})(he,function(t){const i=/[^.]*(?=\..*)\.|.*/,r=/\..*/,o=/::\d+$/,a={};let s=1;const c={mouseenter:"mouseover",mouseleave:"mouseout"},l=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function d(p,v){return v&&`${v}::${s++}`||p.uidEvent||s++}function h(p){const v=d(p);return p.uidEvent=v,a[v]=a[v]||{},a[v]}function u(p,v){return function D(x){return H(x,{delegateTarget:p}),D.oneOff&&B.off(p,x.type,v),v.apply(p,[x])}}function f(p,v,D){return function x(m){const C=p.querySelectorAll(v);for(let{target:_}=m;_&&_!==this;_=_.parentNode)for(const k of C)if(k===_)return H(m,{delegateTarget:_}),x.oneOff&&B.off(p,m.type,v,D),D.apply(_,[m])}}function g(p,v,D=null){return Object.values(p).find(x=>x.callable===v&&x.delegationSelector===D)}function b(p,v,D){const x=typeof v=="string",m=x?D:v||D;let C=A(p);return l.has(C)||(C=p),[x,m,C]}function E(p,v,D,x,m){if(typeof v!="string"||!p)return;let[C,_,k]=b(v,D,x);v in c&&(_=(Le=>function(I){if(!I.relatedTarget||I.relatedTarget!==I.delegateTarget&&!I.delegateTarget.contains(I.relatedTarget))return Le.call(this,I)})(_));const N=h(p),F=N[k]||(N[k]={}),P=g(F,_,C?D:null);if(P){P.oneOff=P.oneOff&&m;return}const K=d(_,v.replace(i,"")),G=C?f(p,D,_):u(p,_);G.delegationSelector=C?D:null,G.callable=_,G.oneOff=m,G.uidEvent=K,F[K]=G,p.addEventListener(k,G,C)}function S(p,v,D,x,m){const C=g(v[D],x,m);C&&(p.removeEventListener(D,C,!!m),delete v[D][C.uidEvent])}function T(p,v,D,x){const m=v[D]||{};for(const[C,_]of Object.entries(m))C.includes(x)&&S(p,v,D,_.callable,_.delegationSelector)}function A(p){return p=p.replace(r,""),c[p]||p}const B={on(p,v,D,x){E(p,v,D,x,!1)},one(p,v,D,x){E(p,v,D,x,!0)},off(p,v,D,x){if(typeof v!="string"||!p)return;const[m,C,_]=b(v,D,x),k=_!==v,N=h(p),F=N[_]||{},P=v.startsWith(".");if(typeof C<"u"){if(!Object.keys(F).length)return;S(p,N,_,C,m?D:null);return}if(P)for(const K of Object.keys(N))T(p,N,K,v.slice(1));for(const[K,G]of Object.entries(F)){const te=K.replace(o,"");(!k||v.includes(te))&&S(p,N,_,G.callable,G.delegationSelector)}},trigger(p,v,D){if(typeof v!="string"||!p)return null;const x=t.getjQuery(),m=A(v),C=v!==m;let _=null,k=!0,N=!0,F=!1;C&&x&&(_=x.Event(v,D),x(p).trigger(_),k=!_.isPropagationStopped(),N=!_.isImmediatePropagationStopped(),F=_.isDefaultPrevented());const P=H(new Event(v,{bubbles:k,cancelable:!0}),D);return F&&P.preventDefault(),N&&p.dispatchEvent(P),P.defaultPrevented&&_&&_.preventDefault(),P}};function H(p,v={}){for(const[D,x]of Object.entries(v))try{p[D]=x}catch{Object.defineProperty(p,D,{configurable:!0,get(){return x}})}return p}return B})}(Jt)),Jt.exports}var ei={exports:{}},ti={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var fn;function cr(){return fn||(fn=1,function(n,e){(function(t,i){n.exports=i()})(he,function(){function t(o){if(o==="true")return!0;if(o==="false")return!1;if(o===Number(o).toString())return Number(o);if(o===""||o==="null")return null;if(typeof o!="string")return o;try{return JSON.parse(decodeURIComponent(o))}catch{return o}}function i(o){return o.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}return{setDataAttribute(o,a,s){o.setAttribute(`data-bs-${i(a)}`,s)},removeDataAttribute(o,a){o.removeAttribute(`data-bs-${i(a)}`)},getDataAttributes(o){if(!o)return{};const a={},s=Object.keys(o.dataset).filter(c=>c.startsWith("bs")&&!c.startsWith("bsConfig"));for(const c of s){let l=c.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),a[l]=t(o.dataset[c])}return a},getDataAttribute(o,a){return t(o.getAttribute(`data-bs-${i(a)}`))}}})}(ti)),ti.exports}/*!
  * Bootstrap config.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var mn;function Oi(){return mn||(mn=1,function(n,e){(function(t,i){n.exports=i(cr(),ke())})(he,function(t,i){class r{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(a){return a=this._mergeConfigObj(a),a=this._configAfterMerge(a),this._typeCheckConfig(a),a}_configAfterMerge(a){return a}_mergeConfigObj(a,s){const c=i.isElement(s)?t.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof c=="object"?c:{},...i.isElement(s)?t.getDataAttributes(s):{},...typeof a=="object"?a:{}}}_typeCheckConfig(a,s=this.constructor.DefaultType){for(const[c,l]of Object.entries(s)){const d=a[c],h=i.isElement(d)?"element":i.toType(d);if(!new RegExp(l).test(h))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${c}" provided type "${h}" but expected type "${l}".`)}}}return r})}(ei)),ei.exports}/*!
  * Bootstrap base-component.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var gn;function ua(){return gn||(gn=1,function(n,e){(function(t,i){n.exports=i(ha(),gt(),Oi(),ke())})(he,function(t,i,r,o){const a="5.3.3";class s extends r{constructor(l,d){super(),l=o.getElement(l),l&&(this._element=l,this._config=this._getConfig(d),t.set(this._element,this.constructor.DATA_KEY,this))}dispose(){t.remove(this._element,this.constructor.DATA_KEY),i.off(this._element,this.constructor.EVENT_KEY);for(const l of Object.getOwnPropertyNames(this))this[l]=null}_queueCallback(l,d,h=!0){o.executeAfterTransition(l,d,h)}_getConfig(l){return l=this._mergeConfigObj(l,this._element),l=this._configAfterMerge(l),this._typeCheckConfig(l),l}static getInstance(l){return t.get(o.getElement(l),this.DATA_KEY)}static getOrCreateInstance(l,d={}){return this.getInstance(l)||new this(l,typeof d=="object"?d:null)}static get VERSION(){return a}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(l){return`${l}${this.EVENT_KEY}`}}return s})}($t)),$t.exports}var ii={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var vn;function Pt(){return vn||(vn=1,function(n,e){(function(t,i){n.exports=i(ke())})(he,function(t){const i=o=>{let a=o.getAttribute("data-bs-target");if(!a||a==="#"){let s=o.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),a=s&&s!=="#"?s.trim():null}return a?a.split(",").map(s=>t.parseSelector(s)).join(","):null},r={find(o,a=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(a,o))},findOne(o,a=document.documentElement){return Element.prototype.querySelector.call(a,o)},children(o,a){return[].concat(...o.children).filter(s=>s.matches(a))},parents(o,a){const s=[];let c=o.parentNode.closest(a);for(;c;)s.push(c),c=c.parentNode.closest(a);return s},prev(o,a){let s=o.previousElementSibling;for(;s;){if(s.matches(a))return[s];s=s.previousElementSibling}return[]},next(o,a){let s=o.nextElementSibling;for(;s;){if(s.matches(a))return[s];s=s.nextElementSibling}return[]},focusableChildren(o){const a=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(a,o).filter(s=>!t.isDisabled(s)&&t.isVisible(s))},getSelectorFromElement(o){const a=i(o);return a&&r.findOne(a)?a:null},getElementFromSelector(o){const a=i(o);return a?r.findOne(a):null},getMultipleElementsFromSelector(o){const a=i(o);return a?r.find(a):[]}};return r})}(ii)),ii.exports}var ni={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var bn;function pa(){return bn||(bn=1,function(n,e){(function(t,i){n.exports=i(gt(),Oi(),ke())})(he,function(t,i,r){const o="backdrop",a="fade",s="show",c=`mousedown.bs.${o}`,l={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},d={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class h extends i{constructor(f){super(),this._config=this._getConfig(f),this._isAppended=!1,this._element=null}static get Default(){return l}static get DefaultType(){return d}static get NAME(){return o}show(f){if(!this._config.isVisible){r.execute(f);return}this._append();const g=this._getElement();this._config.isAnimated&&r.reflow(g),g.classList.add(s),this._emulateAnimation(()=>{r.execute(f)})}hide(f){if(!this._config.isVisible){r.execute(f);return}this._getElement().classList.remove(s),this._emulateAnimation(()=>{this.dispose(),r.execute(f)})}dispose(){this._isAppended&&(t.off(this._element,c),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const f=document.createElement("div");f.className=this._config.className,this._config.isAnimated&&f.classList.add(a),this._element=f}return this._element}_configAfterMerge(f){return f.rootElement=r.getElement(f.rootElement),f}_append(){if(this._isAppended)return;const f=this._getElement();this._config.rootElement.append(f),t.on(f,c,()=>{r.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(f){r.executeAfterTransition(f,this._getElement(),this._config.isAnimated)}}return h})}(ni)),ni.exports}var St={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var yn;function fa(){return yn||(yn=1,function(n,e){(function(t,i){i(e,gt(),Pt(),ke())})(he,function(t,i,r,o){const a=(s,c="hide")=>{const l=`click.dismiss${s.EVENT_KEY}`,d=s.NAME;i.on(document,l,`[data-bs-dismiss="${d}"]`,function(h){if(["A","AREA"].includes(this.tagName)&&h.preventDefault(),o.isDisabled(this))return;const u=r.getElementFromSelector(this)||this.closest(`.${d}`);s.getOrCreateInstance(u)[c]()})};t.enableDismissTrigger=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})}(St,St.exports)),St.exports}var ri={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var wn;function ma(){return wn||(wn=1,function(n,e){(function(t,i){n.exports=i(gt(),Pt(),Oi())})(he,function(t,i,r){const o="focustrap",s=".bs.focustrap",c=`focusin${s}`,l=`keydown.tab${s}`,d="Tab",h="forward",u="backward",f={autofocus:!0,trapElement:null},g={autofocus:"boolean",trapElement:"element"};class b extends r{constructor(S){super(),this._config=this._getConfig(S),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return f}static get DefaultType(){return g}static get NAME(){return o}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),t.off(document,s),t.on(document,c,S=>this._handleFocusin(S)),t.on(document,l,S=>this._handleKeydown(S)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,t.off(document,s))}_handleFocusin(S){const{trapElement:T}=this._config;if(S.target===document||S.target===T||T.contains(S.target))return;const A=i.focusableChildren(T);A.length===0?T.focus():this._lastTabNavDirection===u?A[A.length-1].focus():A[0].focus()}_handleKeydown(S){S.key===d&&(this._lastTabNavDirection=S.shiftKey?u:h)}}return b})}(ri)),ri.exports}var oi={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var En;function ga(){return En||(En=1,function(n,e){(function(t,i){n.exports=i(cr(),Pt(),ke())})(he,function(t,i,r){const o=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",a=".sticky-top",s="padding-right",c="margin-right";class l{constructor(){this._element=document.body}getWidth(){const h=document.documentElement.clientWidth;return Math.abs(window.innerWidth-h)}hide(){const h=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,s,u=>u+h),this._setElementAttributes(o,s,u=>u+h),this._setElementAttributes(a,c,u=>u-h)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,s),this._resetElementAttributes(o,s),this._resetElementAttributes(a,c)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(h,u,f){const g=this.getWidth(),b=E=>{if(E!==this._element&&window.innerWidth>E.clientWidth+g)return;this._saveInitialAttribute(E,u);const S=window.getComputedStyle(E).getPropertyValue(u);E.style.setProperty(u,`${f(Number.parseFloat(S))}px`)};this._applyManipulationCallback(h,b)}_saveInitialAttribute(h,u){const f=h.style.getPropertyValue(u);f&&t.setDataAttribute(h,u,f)}_resetElementAttributes(h,u){const f=g=>{const b=t.getDataAttribute(g,u);if(b===null){g.style.removeProperty(u);return}t.removeDataAttribute(g,u),g.style.setProperty(u,b)};this._applyManipulationCallback(h,f)}_applyManipulationCallback(h,u){if(r.isElement(h)){u(h);return}for(const f of i.find(h,this._element))u(f)}}return l})}(oi)),oi.exports}/*!
  * Bootstrap modal.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(n,e){(function(t,i){n.exports=i(ua(),gt(),Pt(),pa(),fa(),ma(),ke(),ga())})(he,function(t,i,r,o,a,s,c,l){const d="modal",u=".bs.modal",f=".data-api",g="Escape",b=`hide${u}`,E=`hidePrevented${u}`,S=`hidden${u}`,T=`show${u}`,A=`shown${u}`,B=`resize${u}`,H=`click.dismiss${u}`,p=`mousedown.dismiss${u}`,v=`keydown.dismiss${u}`,D=`click${u}${f}`,x="modal-open",m="fade",C="show",_="modal-static",k=".modal.show",N=".modal-dialog",F=".modal-body",P='[data-bs-toggle="modal"]',K={backdrop:!0,focus:!0,keyboard:!0},G={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class te extends t{constructor(I,X){super(I,X),this._dialog=r.findOne(N,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new l,this._addEventListeners()}static get Default(){return K}static get DefaultType(){return G}static get NAME(){return d}toggle(I){return this._isShown?this.hide():this.show(I)}show(I){this._isShown||this._isTransitioning||i.trigger(this._element,T,{relatedTarget:I}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(x),this._adjustDialog(),this._backdrop.show(()=>this._showElement(I)))}hide(){!this._isShown||this._isTransitioning||i.trigger(this._element,b).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(C),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){i.off(window,u),i.off(this._dialog,u),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new o({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new s({trapElement:this._element})}_showElement(I){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const X=r.findOne(F,this._dialog);X&&(X.scrollTop=0),c.reflow(this._element),this._element.classList.add(C);const re=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,i.trigger(this._element,A,{relatedTarget:I})};this._queueCallback(re,this._dialog,this._isAnimated())}_addEventListeners(){i.on(this._element,v,I=>{if(I.key===g){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),i.on(window,B,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),i.on(this._element,p,I=>{i.one(this._element,H,X=>{if(!(this._element!==I.target||this._element!==X.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(x),this._resetAdjustments(),this._scrollBar.reset(),i.trigger(this._element,S)})}_isAnimated(){return this._element.classList.contains(m)}_triggerBackdropTransition(){if(i.trigger(this._element,E).defaultPrevented)return;const X=this._element.scrollHeight>document.documentElement.clientHeight,re=this._element.style.overflowY;re==="hidden"||this._element.classList.contains(_)||(X||(this._element.style.overflowY="hidden"),this._element.classList.add(_),this._queueCallback(()=>{this._element.classList.remove(_),this._queueCallback(()=>{this._element.style.overflowY=re},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const I=this._element.scrollHeight>document.documentElement.clientHeight,X=this._scrollBar.getWidth(),re=X>0;if(re&&!I){const Ne=c.isRTL()?"paddingLeft":"paddingRight";this._element.style[Ne]=`${X}px`}if(!re&&I){const Ne=c.isRTL()?"paddingRight":"paddingLeft";this._element.style[Ne]=`${X}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(I,X){return this.each(function(){const re=te.getOrCreateInstance(this,I);if(typeof I=="string"){if(typeof re[I]>"u")throw new TypeError(`No method named "${I}"`);re[I](X)}})}}return i.on(document,D,P,function(Le){const I=r.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&Le.preventDefault(),i.one(I,T,Ne=>{Ne.defaultPrevented||i.one(I,S,()=>{c.isVisible(this)&&this.focus()})});const X=r.findOne(k);X&&te.getInstance(X).hide(),te.getOrCreateInstance(I).toggle(this)}),a.enableDismissTrigger(te),c.defineJQueryPlugin(te),te})})(lr);var Dt=lr.exports;class dr extends window.Controller{constructor(e){super(e),this.attachments={},this.mediaList=[],this.allMediaList={}}initialize(){this.page=1}get dropname(){return this.element.querySelector("#"+this.element.dataset.uploadId)}get activeAttachment(){return{id:this.activeAchivmentId,name:this[this.getAttachmentTargetKey("name")].value||"",alt:this[this.getAttachmentTargetKey("alt")].value||"",description:this[this.getAttachmentTargetKey("description")].value||"",original_name:this[this.getAttachmentTargetKey("original")].value||""}}set activeAttachment(e){this.activeAchivmentId=e.id,this[this.getAttachmentTargetKey("name")].value=e.name||"",this[this.getAttachmentTargetKey("original")].value=e.original_name||"",this[this.getAttachmentTargetKey("alt")].value=e.alt||"",this[this.getAttachmentTargetKey("description")].value=e.description||"",this.data.set("url",e.url)}openLink(e){e.preventDefault(),window.open(this.data.get("url"))}connect(){this.initDropZone(),this.initSortable()}save(){const e=this.activeAttachment,t=this.dropname;Dt.Modal.getOrCreateInstance(t.querySelector(".attachment.modal")).toggle();const r=e.name+e.id;this.attachments.hasOwnProperty(r)&&(this.attachments[r].name=e.name,this.attachments[r].alt=e.alt,this.attachments[r].description=e.description,this.attachments[r].original_name=e.original_name),axios.put(this.prefix(`/systems/files/post/${e.id}`),e).then()}getAttachmentTargetKey(e){return`${e}Target`}loadInfo(e){const t=e.name+e.id;this.attachments.hasOwnProperty(t)||(this.attachments[t]=e),this.activeAttachment=e}resortElement(){const e={},t=this,i=this.dropname,r=axios.CancelToken;typeof this.cancelRequest=="function"&&this.cancelRequest(),i.querySelectorAll(":scope .file-sort").forEach((a,s)=>{const c=a.getAttribute("data-file-id");e[c]=s}),axios.post(this.prefix("/systems/files/sort"),{files:e},{cancelToken:new r(function(s){t.cancelRequest=s})}).then()}initSortable(){new O(this.element.querySelector(".sortable-dropzone"),{animation:150,onEnd:()=>{this.resortElement()}})}addSortDataAtributes(e,t,i){const r=e.querySelectorAll(" .dz-complete");r!==null&&r.item(r.length-1)!==null&&(r.item(r.length-1).setAttribute("data-file-id",i.id),r.item(r.length-1).classList.add("file-sort"));const o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",t+"[]"),o.setAttribute("value",i.id),o.classList.add("files-"+i.id),e.appendChild(o)}initDropZone(){const e=this,t=this.element.dataset.uploadId,i=this.element.dataset.uploadData&&JSON.parse(this.element.dataset.uploadData),r=this.element.dataset.uploadStorage,o=this.element.dataset.uploadName,a=this.loadInfo.bind(this),s=this.dropname,c=this.element.dataset.uploadGroups,l=this.element.dataset.uploadPath,d=this.element.dataset.uploadMultiple;this.element.dataset.uploadIsMediaLibrary;const h=this.element.querySelector("#"+t+"-remove-button").innerHTML.trim(),u=this.element.querySelector("#"+t+"-edit-button").innerHTML.trim(),f=this;this.prefix("/systems/files/"),console.log(i),this.dropZone=new y(this.element.querySelector("#"+t),{url:this.prefix("/systems/files"),method:"post",uploadMultiple:!0,maxFilesize:this.element.dataset.uploadMaxFileSize,maxFiles:d?this.element.dataset.uploadMaxFiles:1,timeout:this.element.dataset.uploadTimeout,acceptedFiles:this.element.dataset.uploadAcceptedFiles,resizeQuality:this.element.dataset.uploadResizeQuality,resizeWidth:this.element.dataset.uploadResizeWidth,resizeHeight:this.element.dataset.uploadResizeHeight,paramName:"files",previewsContainer:s.querySelector(".visual-dropzone"),addRemoveLinks:!1,dictFileTooBig:"File is big",autoDiscover:!1,init:function(){this.on("addedfile",E=>{this.files.length>this.options.maxFiles&&(f.alert("Ошибка проверки","Максимум файлов"),this.removeFile(E));const S=y.createElement(u),T=y.createElement(h);T.addEventListener("click",A=>{A.preventDefault(),A.stopPropagation(),this.removeFile(E)}),S.addEventListener("click",()=>{a(E.data),Dt.Modal.getOrCreateInstance(s.querySelector(".attachment.modal")).show()}),E.previewElement.appendChild(T),E.previewElement.appendChild(S)}),this.on("maxfilesexceeded",E=>{f.alert("Ошибка проверки","Превышено максимальное количество файлов"),this.removeFile(E)}),this.on("sending",(E,S,T)=>{let A=document.querySelector("meta[name='csrf_token']").getAttribute("content");T.append("_token",A),T.append("storage",r),T.append("group",c),T.append("path",l)}),this.on("removedfile",E=>{if(E.hasOwnProperty("data")&&E.data.hasOwnProperty("id")){let S=s.querySelector(`.files-${E.data.id}`);S!==null&&S.parentNode!==null&&S.parentNode.removeChild(S)}}),d||this.hiddenFileInput.removeAttribute("multiple");const g=i;g&&Object.values(g).forEach(E=>{const S={id:E.id,name:E.original_name,size:E.size,type:E.mime,status:y.ADDED,url:`${E.url}`,data:E};this.emit("addedfile",S),this.emit("thumbnail",S,S.url),this.emit("complete",S),this.files.push(S),e.addSortDataAtributes(s,o,E)});let b=s.querySelector(".dz-progress");b!==null&&b.parentNode!==null&&b.parentNode.removeChild(b)},error(g,b){return f.alert("Ошибка валидации","Ошибка загрузки файла"),this.removeFile(g),Object.prototype.toString.call(b).replace(/^\[object (.+)\]$/,"$1").toLowerCase()==="string"?b:b.message},success(g,b){Array.isArray(b)||(b=[b]),b.forEach(E=>{if(g.name===E.original_name)return g.data=E,!1}),e.addSortDataAtributes(s,o,g.data),e.resortElement()}})}openMedia(){const e=this.dropname;e.querySelector(".media-loader").style.display="",e.querySelector(".media-results").style.display="none",this.resetPage(),this.loadMedia()}loadMore(e){e.preventDefault(),this.page++,this.loadMedia()}resetPage(){this.allMediaList={},this.page=1,this.dropname.querySelector(".media-results").innerHTML=""}loadMedia(){const e=this,t=axios.CancelToken,i=this.dropname;typeof this.cancelRequest=="function"&&this.cancelRequest(),Dt.Modal.getOrCreateInstance(i.querySelector(".media.modal")).show();let o={disk:this.element.dataset.uploadStorage,original_name:this.searchTarget.value,group:this.element.dataset.uploadGroups||null};Object.keys(o).forEach(a=>o[a]===null&&delete o[a]),axios.post(this.prefix(`/systems/media?page=${this.page}`),{filter:o},{cancelToken:new t(function(s){e.cancelRequest=s})}).then(a=>{this.mediaList=a.data.data,this.loadmoreTarget.classList.toggle("d-none",a.data.last_page===this.page),this.renderMedia()})}renderMedia(){this.mediaList.forEach((e,t)=>{const i=this.page+"-"+t,r=this.element.querySelector("#"+this.data.get("id")+"-media").content.querySelector(".media-item").cloneNode(!0);r.innerHTML=r.innerHTML.replace(/{index}/,i).replace(/{element.url}/,e.url).replace(/{element.original_name}/,e.original_name).replace(/{element.original_name}/,e.original_name),this.dropname.querySelector(".media-results").appendChild(r),this.allMediaList[i]=e}),this.dropname.querySelector(".media-loader").style.display="none",this.dropname.querySelector(".media-results").style.display=""}addFile(e){const t=e.currentTarget.dataset.key,i=this.allMediaList[t];this.addedExistFile(i),this.data.get("close-on-add")&&Dt.Modal.getOrCreateInstance(this.dropname.querySelector(".media.modal")).hide()}addedExistFile(e){const i=!!this.element.dataset.uploadMultiple?this.element.dataset.uploadMaxFiles:1;if(this.dropZone.files.length>=i){this.alert("Превышено максимальное количество файлов");return}const r={id:e.id,name:e.original_name,size:e.size,type:e.mime,status:y.ADDED,url:`${e.url}`,data:e};this.dropZone.emit("addedfile",r),this.dropZone.emit("thumbnail",r,r.url),this.dropZone.emit("complete",r),this.dropZone.files.push(r),this.addSortDataAtributes(this.dropname,this.element.dataset.uploadName,r),this.resortElement()}}Ze(dr,"targets",["search","name","original","alt","description","url","loadmore"]);application.register("cropperrocont",gi);application.register("tinymce",Ao);application.register("uploaderrocont",dr);
